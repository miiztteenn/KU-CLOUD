import {
    deepCopy,
    convertHex,
    randomHexColor,
    aproximateHour,
    filter_hour,
    diff_hours,
    getRndInteger,
    checkAuthRes,
    getFlatObject,
    getFlatObjectV2
} from '../utility';

var companyList  = [];

$(document).ready(function () {

    $.ajax({
        url: END_POINT + "companyList/public",
        method: 'GET',
        success: function (result, textStatus, xhr) {
            checkAuthRes(xhr);
            companyList = result.data;
            console.log(companyList);
            appendCardList();
        },
        error: function (error) {
            console.log(error);
        }
    });

});

function appendCardList(){
    let htmlText = "";
    let pathsrc = $("#path_src").val();

    for(let i = 0; i < companyList.length; i++)
    {
        htmlText += `<div class="col-xl-3 col-6 mt-4">
                        <div class="card" style="box-shadow: 0px 0px 13px 1px rgba(0,0,0,0.3);">
                            <div style="text-align:center">
                                <img class="card-img-top" src="${pathsrc}" alt="Card image cap" style="height:60%; width:80%">
                            </div>
                            <hr>
                            <div class="card-body">
                                <h5 class="card-title">${companyList[i].company_name}</h5>
                                <p class="card-text">${companyList[i].note}</p>
                                <div id="btn_space" style="text-align:right">
                                    <button class="btn btn-info" value="${i}">Detail</button>
                                </div>
                            </div>
                        </div>
                    </div>`;
    }

    $("#space_list").html(htmlText);

    $("#space_list").on('click', '.btn-info', function () {
        $(".modal-title").html(companyList[$(this).val()].company_name);

        $("#address_detail").html(companyList[$(this).val()].address[0].address_detail);
        $("#address_district").html(companyList[$(this).val()].address[0].dNameTh);
        $("#address_amphure").html(companyList[$(this).val()].address[0].aNameTh);
        $("#address_province").html(companyList[$(this).val()].address[0].pNameTh + " " + companyList[$(this).val()].address[0].zip_code);

        $("#company_detail").modal('show');

    });
}

