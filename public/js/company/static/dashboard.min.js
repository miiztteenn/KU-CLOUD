!function(t){var e={};function a(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="http://localhost:8080/",a(a.s=0)}({0:function(t,e,a){t.exports=a("AG5F")},"0v0P":function(t,e,a){"use strict";a.d(e,"b",function(){return i}),a.d(e,"a",function(){return l});var i=function(t){return t.map(function(t){return Object.assign({},t)})},n=null,l={set:function(t){n=t.html();var e=t.attr("data-loading-text");t.html(e),t.prop("disabled",!0)},reset:function(t){t.html(n),t.prop("disabled",!1)}}},AG5F:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__utility_js__=__webpack_require__("0v0P"),__WEBPACK_IMPORTED_MODULE_1_file_saver__=__webpack_require__("t4zo"),__WEBPACK_IMPORTED_MODULE_1_file_saver___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_file_saver__),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}();function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Chart.defaults.global.defaultFontFamily="'Poppins', 'Kanit', 'sans-serif'";var END_POINT="http://localhost:8000/api/",Datasource=null,ModalEditWidget=function t(e){var a=this;_classCallCheck(this,t),this.widget=e;var i=null;this.createModalEdit=function(t,e){null===i&&(i='<div class="modal fade" id="EditWidget">\n                                        <div class="modal-dialog modal-lg">\n                                            <div class="modal-content">\n                                                <div class="modal-header">\n                                                    <h5 class="modal-title">Edit Widget</h5>\n                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>\n                                                </div>\n\n                                                <div class="modal-body" id="form-edit-widget">     \n                                                </div>\n\n                                                <div class="modal-footer">\n                                                    <button type="button" id="btn-submit-edit-widget" class="btn btn-success btn-block">Save</button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>',$("body").append(i)),$("#form-edit-widget").html(t),$("#EditWidget").modal("show")},this.submitEditClick=function(t){$("#btn-submit-edit-widget").unbind().click(function(){t()})},this.closeModalEdit=function(){$("#EditWidget").modal("hide")},this.findTitleWidget=function(){return $("#"+a.widget.itemId).find(".title-widget")}},ModalEditWidgetMutiLine=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val();$(a.findTitleWidget()).html(t),a.widget.title_name=t,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                            <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name)},a}return _inherits(e,ModalEditWidget),e}(),ModalEditWidgetGauges=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val(),i=a.widget.itemId.replace("item-","unit_");$(a.findTitleWidget()).html(t),$("#"+i).html(e),a.widget.title_name=t,a.widget.unit=e,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div id="edit-Gauges" class="edit-widget-form"> \n                            <div class="row">\n                                <div class="col-6">\n                                    <lable>Title</label>\n                                    <input type="text" class="form-control" id="edit-title"/>\n                                </div>\n                                <div class="col-6">\n                                    <lable>Unit</label>\n                                    <input type="text" class="form-control" id="edit-unit"/>\n                                </div>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},a}return _inherits(e,ModalEditWidget),e}(),ModalEditWidgetMap=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val();$(a.findTitleWidget()).html(t),a.widget.title_name=t,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                            <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name)},a}return _inherits(e,ModalEditWidget),e}(),ModalEditTextValue=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val();$(a.findTitleWidget()).html(t),$("#"+a.widget.widgetId).next("span").html(e),a.widget.title_name=t,a.widget.unit=e,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                                <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                            <div class="col-6">\n                                <lable>Unit</label>\n                                <input type="text" class="form-control" id="edit-unit"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},a}return _inherits(e,ModalEditWidget),e}(),ModalEditTextLine=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val(),i=a.widget.itemId.replace("item-","unit_");$(a.findTitleWidget()).html(t),$("#"+i).html(e),a.widget.title_name=t,a.widget.unit=e,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                                <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                            <div class="col-6">\n                                <lable>Unit</label>\n                                <input type="text" class="form-control" id="edit-unit"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},a}return _inherits(e,ModalEditWidget),e}(),ModalEditWidgetTextBox=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){$("#"+t.widgetId).html($("#edit-text-custom").val()),$("#"+t.widgetId).css({"font-size":$("#edit-font-size").val()+"px"}),t.textbox=$("#edit-text-custom").val(),t.fontsize=$("#edit-font-size").val(),a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div id = "edit-text-box" class="value_widget">\n                            <div class="row">\n                                <div class="col-6">\n                                    <label>Text</label>\n                                    <input type="text" id="edit-text-custom" class="form-control" />\n                                </div>\n                                <div class="col-6">\n                                    <label>Font Size (px)</label>\n                                    <input type="number" id="edit-font-size" class="form-control" />\n                                </div>\n                            </div>\n                        </div> ',i),i(),$("#edit-text-custom").val(t.textbox),$("#edit-font-size").val(t.fontsize)},a}return _inherits(e,ModalEditWidget),e}(),Widget=function(){function t(e){var a=this;_classCallCheck(this,t),this.itemId=e.itemId,this.widgetId=e.widgetId,this.datasource=e.datasource,this.type=e.type,this.lastUpdateId=e.lastUpdateId,this.title_name=e.title_name,this.lastUpdate=e.lastUpdate,this.timeInterval=e.timeInterval,this.wi=e.wi,this.download=e.download,this.updateLastUpdate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?(a.lastUpdate=new Date(t),$("#"+a.lastUpdateId).html(a.lastUpdate.toDateString()+" "+a.lastUpdate.toLocaleTimeString())):(a.lastUpdate=new Date,$("#"+a.lastUpdateId).html(a.lastUpdate.toDateString()+" "+a.lastUpdate.toLocaleTimeString()))};var i={cellHeight:80,verticalMargin:10,float:!1},n=[{x:0,y:0,width:6,height:7}],l=null,o=null,d=function(){$(".btn-delete-wi").unbind().click(function(){r($(this))}),$(".btn-edit-wi").unbind().click(function(){var t,e,a,i;t=$(this),e=$(t).attr("item"),a=Dashboard.getWidgetById(e),i=null,"MutiLine"===a.type?i=new ModalEditWidgetMutiLine(a):"text-line"===a.type?i=new ModalEditTextLine(a):"Gauges"===a.type?i=new ModalEditWidgetGauges(a):"Map"===a.type?i=new ModalEditWidgetMap(a):"TextValue"===a.type?i=new ModalEditTextValue(a):"TextBox"===a.type&&(i=new ModalEditWidgetTextBox(a)),i.initCreate()}),$(".btn-full-screen").unbind().click(function(){s($(this))}),$(".btn-download").unbind().click(function(){var t=Dashboard.getWidgetById($(this).attr("item"));document.getElementById(t.widgetId).toBlob(function(t){__WEBPACK_IMPORTED_MODULE_1_file_saver___default()(t,"image.jpg")})})},s=function(t){var e=Dashboard.getWidgetById(t.attr("item"));$("#modal-full-screen").modal("show"),$("#content-widget").html(e.selectWiContentFull()),e.createFullWidget()},r=function(t){null===o&&(o='\n                <div class="modal fade" id="DeleteWidget">\n                    <div class="modal-dialog modal-dialog-centered">\n                        <div class="modal-content">\n                            <div class="modal-header">\n                                <h5 class="modal-title">Delete Widget</h5>\n                                <button type="button" class="close" data-dismiss="modal">&times;</button>\n                            </div>\n    \n                            <div class="modal-body">\n                                <h6>Are you sure to delete this widget?</h6>\n                            </div>\n    \n                            <div class="modal-footer">\n                                <button type="button" id="" class="btn btn-danger btn-block btn-submit-delete-widget">Delete</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>',$("body").append(o)),$("#DeleteWidget").modal("show"),$(".btn-submit-delete-widget").unbind().click(function(){c($(t)),$("#DeleteWidget").modal("hide")})},c=function(t){var e=$(t).attr("item");l.removeWidget($("#"+e).closest(".grid-stack-item"));var a=widgetList.findIndex(function(t){return t.itemId==e});widgetList.splice(a,1)};this.selectWiContent=function(){switch(a.type){case"MutiLine":return'<canvas id="'+a.widgetId+'"></canvas>';case"text-line":return' <h2 class="text-left"><span id="'+a.itemId.replace("item-","value_")+'">0</span> <span  id="'+a.itemId.replace("item-","unit_")+'">'+a.unit+'</span></h2>\n                             <canvas id="'+a.widgetId+'"></canvas>\n                            ';case"Gauges":return a.itemId.replace("item-","gauges-text-"),a.itemId.replace("item-","unit_"),'\n                            \n                            <div id="'+a.widgetId+'"></div>\n                            ';case"Map":return'\n                            <div id="'+a.widgetId+'"></div>\n                            ';case"TextValue":return'\n                            <h1 style="color:'+a.rgb+'"><span id="'+a.widgetId+'">0</span> <span>'+a.unit+"</span><h1>\n                            ";case"TextBox":return'<span id="'+a.widgetId+'"></span>'}},this.selectWiContentFull=function(){switch(a.type){case"MutiLine":return'<canvas id="'+a.fullScreenId+'"></canvas>';case"text-line":return' <h2 class="text-left"><span id="'+a.itemId.replace("item-","value_full")+'">0</span> '+a.unit+'</h2>\n                             <canvas id="'+a.fullScreenId+'"></canvas>\n                            ';case"Gauges":return'\n                            <h2><span id="'+a.itemId.replace("item-","gauges-text-full")+'">0</span> <span>'+a.unit+'</span></h2>\n                            <canvas id="'+a.fullScreenId+'"></canvas>\n                            ';case"Map":return'\n                            <div id="'+a.fullScreenId+'"></div>\n                            '}},this.createWidget=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=n.pop()||{x:3,y:4,width:6,height:7};$(".grid-stack").gridstack(i),l=$(".grid-stack").data("gridstack");var o="";"TextBox"!==a.type?(o=$("#layout-widget").html(),"TextValue"===a.type&&(e.width=4,e.height=4,o=$("#layout-widget-text-value").html()),o=(o=(o=(o=(o=o.replace(/div_id/g,a.itemId)).replace(/widget_id/g,a.widgetId)).replace("((wi))",a.selectWiContent())).replace("((title_name))",a.title_name)).replace("{last_update}",a.lastUpdateId)):(e.width=6,e.height=1,o=(o=(o=$("#layout-widget-text").html()).replace(/div_id/g,a.itemId)).replace("((wi))",a.selectWiContent())),e.id=a.itemId;var s,r,c=null;c=t?l.addWidget($(o),t.x,t.y,t.width,t.height,!0,null,null,null,null,e.id):l.addWidget($(o),e.x,e.y,e.width,e.height,!0,null,null,null,null,e.id),a.download||c.find(".full-screen").find(".btn-download").remove(),c.data("_gridstack_data",JSON.stringify((r={type:(s=a).type,datasource:s.datasource,timeInterval:s.timeInterval},"MutiLine"===s.type?(r.title_name=s.title_name,r.datasets=s.datasets):"text-line"===s.type?(r.title_name=s.title_name,r.unit=s.unit,r.rgb=s.rgb):"Gauges"===s.type?(r.title_name=s.title_name,r.opts=s.opts,r.limitMin=s.limitMin,r.limitMax=s.limitMax,r.unit=s.unit):"Map"===s.type?r.title_name=s.title_name:"TextValue"===s.type?(r.title_name=s.title_name,r.unit=s.unit,r.rgb=s.rgb):"TextBox"===s.type&&(r.textbox=s.textbox,r.fontsize=s.fontsize),r))),d()}}return _createClass(t,null,[{key:"formateDataSave",value:function(t){var e={type:t.type,download:!!t.download&&t.download,timeInterval:t.timeInterval};return"MutiLine"===t.type?(e.title_name=t.title_name,e.datasets=t.datasets):"text-line"===t.type?(e.title_name=t.title_name,e.unit=t.unit,e.rgb=t.rgb):"Gauges"===t.type?(e.title_name=t.title_name,e.opts=t.opts,e.limitMin=t.limitMin,e.limitMax=t.limitMax,e.unit=t.unit):"Map"===t.type?e.title_name=t.title_name:"TextValue"===t.type?(e.title_name=t.title_name,e.unit=t.unit,e.rgb=t.rgb):"TextBox"===t.type&&(e.textbox=t.textbox,e.fontsize=t.fontsize),e}}]),t}(),MutiLine=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.fullScreenId=t.fullScreenId,a.chart=null,a.datasets=t.datasets;var i={maintainAspectRatio:!1,scales:{yAxes:[{gridLines:{display:!1},ticks:{beginAtZero:!0,fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontStyle:"bold"}}],xAxes:[{gridLines:{display:!1},ticks:{fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontStyle:"bold"}}]},legend:{labels:{fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontColor:"black"}}};return a.createMutiLine=function(){var t=document.getElementById(a.widgetId),e=new Chart(t,{type:"line",data:{datasets:Object(__WEBPACK_IMPORTED_MODULE_0__utility_js__.b)(a.datasets)},options:i});a.chart=e},a.createFullWidget=function(){var t=document.getElementById(a.fullScreenId);new Chart(t,{type:"line",data:{datasets:Object(__WEBPACK_IMPORTED_MODULE_0__utility_js__.b)(a.datasets)},options:i})},a.updateData=function(){var t=a.chart,e=(Math.random(),new Date);t.data.labels.push(e.toLocaleTimeString()),t.data.datasets.forEach(function(t){t.data.length>10&&t.data.splice(0,1),t.data.push(Datasource.getDatasourceValue(a.datasource))}),t.data.labels.length>10&&t.data.labels.splice(0,1),t.update(),a.updateLastUpdate()},a}return _inherits(e,Widget),e}(),ChartTextLine=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.fullScreenId=t.fullScreenId,a.unit=t.unit,a.rgb=t.rgb;var i={maintainAspectRatio:!1,responsive:!0,scales:{yAxes:[{display:!1}],xAxes:[{display:!1}]},legend:{display:!1},elements:{point:{radius:0},line:{tension:0}},layout:{padding:{left:0,right:0,top:0,bottom:30}},stepsize:100};return a.createTextLine=function(){var t=document.getElementById(a.widgetId),e=new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:["rgba(255, 255, 255, 0)"],borderColor:[a.rgb],borderWidth:2}]},options:i});return a.chart=e,a.updateData(),e},a.createFullWidget=function(){var t=document.getElementById(a.fullScreenId);new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:["rgba(255, 255, 255, 0)"],borderColor:[a.rgb],borderWidth:2}]},options:i})},a.updateData=function(){var t=a.widgetId;t=t.replace("myChart_","value_");var e=a.chart,i=Math.floor(100+900*Math.random()),n=new Date;e.data.labels.push(n.toLocaleTimeString()),e.data.datasets.forEach(function(e){e.data.length>10&&e.data.splice(0,1),e.data.push(i),$("#"+t).html(i)}),e.data.labels.length>10&&e.data.labels.splice(0,1),e.update(),a.updateLastUpdate()},a.liveData=function(){var t=a.widgetId;t=t.replace("myChart_","value_");var e=a.chart,i=new Date;e.data.labels.push(i.toLocaleTimeString()),e.data.datasets.forEach(function(t){t.data.length>10&&t.data.splice(0,1);var e=t.data[t.data.length-1];t.data.push(e)}),e.data.labels.length>10&&e.data.labels.splice(0,1),e.update()},a}return _inherits(e,MutiLine),e}(),Gauges=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.fullScreenId=t.fullScreenId,a.textId=t.textId,a.gaugeWidget=null,a.opts=t.opts,a.limitMax=t.limitMax?t.limitMax:100,a.limitMin=t.limitMin?t.limitMin:0,a.unit=t.unit,a.createGages=function(){a.gaugeWidget=new JustGage({id:a.widgetId,value:getRandomInt(Number(a.limitMin),Number(a.limitMax)),min:a.limitMin,max:a.limitMax,symbol:" "+a.unit,relativeGaugeSize:!0,titlePosition:"below"}),$("#"+a.widgetId).height($("#"+a.widgetId).height()-5),$("#"+a.widgetId).addClass("container"),a.updateData()},a.updateData=function(){a.gaugeWidget.refresh(getRandomInt(Number(a.limitMin),Number(a.limitMax))),a.updateLastUpdate()},a}return _inherits(e,Widget),e}(),Map=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.fullScreenId=t.fullScreenId,a.myMap=null,a.createMap=function(){var t=void 0,e=a.widgetId,i=$("#"+a.itemId).height()-100;$("#"+e).css("height",i),$("#"+e).css("width","auto"),t=L.map(e,{dragging:!0,zoomControl:!0,scrollWheelZoom:!1,zoomAnimation:!1}),$.getJSON("https://raw.githubusercontent.com/apisit/thailand.json/master/thailand.json").then(function(e){var a=new L.TileLayer.BoundaryCanvas("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{boundary:e,minZoom:5,maxZoom:9,attribution:"&copy; Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"});t.addLayer(a);var i=L.geoJSON(e);t.fitBounds(i.getBounds())}).then(function(){setTimeout(function(){t.invalidateSize(!0),$.ajax({dataType:"json",url:"/js/company/test-api.json",async:!1,success:function(e){var a=[],i=e.WeatherForecasts;for(var n in i)L.marker([i[n].location.lat,i[n].location.lon]).addTo(t).bindPopup(i[n].location.province+" อ ุณหภูมิที่ระดับพื้นผิว : "+i[n].forecasts[1].data.tc+" °C"),a.push([i[n].location.lat,i[n].location.lon,i[n].forecasts[1].data.tc/100]);L.heatLayer(a,{radius:75}).addTo(t)}})},1e3)}),$(".grid-stack").on("change",function(e,a){null!=t&&t.invalidateSize(!0)}),a.myMap=t,console.log(a.myMap)},a.createFullWidget=function(){var t=void 0,e=a.fullScreenId;$("#"+e).css("height","450px"),$("#"+e).css("width","auto"),t=L.map(e,{dragging:!0,zoomControl:!0,scrollWheelZoom:!1,zoomAnimation:!1}),$.getJSON("https://raw.githubusercontent.com/apisit/thailand.json/master/thailand.json").then(function(e){var a=new L.TileLayer.BoundaryCanvas("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{boundary:e,minZoom:5,maxZoom:9,attribution:"&copy; Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"});t.addLayer(a);var i=L.geoJSON(e);t.fitBounds(i.getBounds())}).then(function(){setTimeout(function(){t.invalidateSize(!0),$.ajax({dataType:"json",url:"/js/company/test-api.json",async:!1,success:function(e){var a=[],i=e.WeatherForecasts;for(var n in i)L.marker([i[n].location.lat,i[n].location.lon]).addTo(t).bindPopup(i[n].location.province+" อ ุณหภูมิที่ระดับพื้นผิว : "+i[n].forecasts[1].data.tc+" °C"),a.push([i[n].location.lat,i[n].location.lon,i[n].forecasts[1].data.tc/100]);L.heatLayer(a,{radius:75}).addTo(t)}})},1e3)})},a}return _inherits(e,Widget),e}(),TextValue=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.textValue=t.textValue,a.unit=t.unit,a.rgb=t.rgb,a.createTextValue=function(){a.updateData()},a.updateData=function(){var t=Math.floor(99*Math.random());$("#"+a.widgetId).html(t),a.updateLastUpdate()},a}return _inherits(e,Widget),e}(),TextBox=function(t){function e(t){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.textbox=t.textbox,a.fontsize=t.fontsize,a.createTextBox=function(){console.log($("#"+a.widgetId)),$("#"+a.widgetId).html(a.textbox),$("#"+a.widgetId).css({"font-size":a.fontsize+"px"})},a}return _inherits(e,Widget),e}(),widgetList=[],Datasources=function Datasources(){_classCallCheck(this,Datasources);var listDatasource=null,datasources=[],apiSelect="datasources",getWebServices=function(){$.ajax({url:END_POINT+"company/webservices",success:function(t){(listDatasource=t.data).map(function(t){$("#webservice_id").append('<option value="'+t.webservice_id+'">'+t.service_name+"</option>")})},error:function(t){console.log(t)}})},getDatasource=function(){$.ajax({url:END_POINT+"company/staticDatasource",method:"GET",data:{static_id:$("#static_id").html()},success:function(t){listDatasource=t.data,updateListDatasource()},error:function(t){console.log(t)}})},addDatasource=function(){$.ajax({url:END_POINT+"company/static/datasource",method:"POST",data:{static_id:$("#static_id").html(),name:$("#name_datasource").val(),webservice_id:$("#webservice_id").val()},success:function(t){getDatasource(),$("#addDatasource").modal("hide")},error:function(t){console.log(t)}})},updateListDatasource=function(){$("#list-datasource").empty(),$(".select-datasource").empty();var t="<h5>Datasource</h5>",e="<option value=''>--Select datasource--</option>";listDatasource.map(function(a,i){t+='<div class="row">\n                            <div class="col-2">\n                                '+a.name+'\n                            </div>\n                            <div class="col-2" id="datasource-isActive-'+i+'">\n                                Not active\n                            </div>\n                            <div class="col-3" id="datasource-'+i+'">\n\n                            </div>\n                        </div>',e+="<option value='"+a.id+"'>"+a.name+"</option>",getApiDatasource(i)}),$(".select-datasource").html(e),$("#list-datasource").html(t)},getApiDatasource=function(t){listDatasource[t].URL;var e=listDatasource[t].name;$.ajax({url:"/js/company/test-api.json",success:function(a){var i=new Date;$("#datasource-"+t).html(i.toDateString()+" "+i.toLocaleTimeString()),$("#datasource-isActive-"+t).html("Active"),datasources[e]=a},error:function(t){console.log(t)}})},findDatasource=function(t){return listDatasource.find(function(e){return e.id==t})},createDataList=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;$("#data-list").empty();var a=apiSelect+"['"+t+"']";$(e).val(a),updateDataList(a)},updateDataList=function updateDataList(value){var el=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("object"==_typeof(eval(value))){var key=Object.keys(eval(value));$("#data-list").empty(),key.map(function(_key){var test=value+"['"+_key+"']";$("#data-list").append('<li class="value-data list-group-item" style="cursor:pointer" value="'+_key+'">'+_key+" : "+eval(test)+"</li>")}),$(".value-data").unbind().click(function(){var t=$(this).parent().parent().find(".value-datasource");console.log(t);var e=$(t).val();e+="['"+$(this).attr("value")+"']",$(t).val(e),updateDataList($(t).val())})}else $("#data-list").empty()};this.getDatasourceValue=function(value){return console.log(eval(value)),eval(value)};var bindElement=function(){$("#btn-add-datasource").unbind().click(function(){$("#addDatasource").modal("show")}),$("#btn-add-new-datasource").unbind().click(function(){addDatasource()}),$(".select-datasource").change(function(){if($(this).parent().next().find(".value-datasource").val(""),$("#data-list").empty(),""!=$(this).val()){var t=findDatasource($(this).val());createDataList(t.name,$(this).parent().next().find(".value-datasource"))}}),$(".value-datasource").keyup(function(){updateDataList($(this).val(),$(this))})};this.initCreate=function(){bindElement(),getWebServices(),getDatasource()}},Dashboard=function(){function t(){_classCallCheck(this,t);var e={cellHeight:80,verticalMargin:10,float:!1},a=null,i=null,n=function(){return $("#widget_type").val()},l=function(){return $("#title-name").val()},o=function(){return $("#time-interval").val()},d=function(){return(new Date).toUTCString()},s=function(){var t=n(),e=Math.floor(1e5+9e5*Math.random()),a=null,i=null;"MutiLine"===t?(i=function(t){for(var e=$("#Mutiline_value").find(".label-y-chart-line").length,a=($("#Mutiline_value").find(".value-datasource"),[]),i=0;i<e;i++){var s,r=$("#Mutiline_value").find(".label-y-chart-line"),c=$("#Mutiline_value").find(".rgb-chart-line");s={label:$(r[i]).val(),backgroundColor:"rgba(255,255,255,0.0)",borderColor:$(c[i]).val(),borderWidth:2},a.push(s)}return{itemId:"item-"+t,widgetId:"myChart_"+t,datasource:value_datasource,lastUpdateId:"myChartLastUpdate_"+t,fullScreenId:"myChartFull_"+t,download:!0,type:n(),title_name:l(),lastUpdate:d(),timeInterval:o(),datasets:[].concat(a)}}(e),(a=new MutiLine(Object.assign({},i))).createWidget(),a.createMutiLine()):"text-line"===t?(i=function(t){var e=$("#text-line").find("#unit").val(),a=$("#value-text-line").find("#rgb").val();return{itemId:"item-"+t,widgetId:"myChart_"+t,lastUpdateId:"myChartLastUpdate_"+t,fullScreenId:"myChartFull_"+t,download:!0,type:n(),title_name:l(),lastUpdate:d(),timeInterval:o(),rgb:a,unit:e}}(e),(a=new ChartTextLine(i)).createWidget(),a.createTextLine()):"Gauges"===t?(i=function(t){var e=$("#Gauges").find("#g_limitMin").val(),a=$("#Gauges").find("#g_limitMax").val(),i=$("#Gauges").find("#unit").val();return{textId:"gauges-text-"+t,itemId:"item-"+t,widgetId:"gauges-"+t,lastUpdateId:"gaugesLastUpdate-"+t,fullScreenId:"gaugesFull-"+t,download:!1,type:n(),title_name:l(),lastUpdate:d(),timeInterval:o(),limitMax:a,limitMin:e,unit:i,opts:{angle:0,lineWidth:.23,radiusScale:1,pointer:{length:.6,strokeWidth:.035,color:"#000000"},limitMax:!1,limitMin:!1,colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:!0,highDpiSupport:!0,staticLabels:{font:"10px Poppins",labels:[0,Number(a)],color:"#000000",fractionDigits:0}}}}(e),(a=new Gauges(i)).createWidget(),a.createGages()):"Map"===t?(i=function(t){return{itemId:"item-"+t,widgetId:"map-"+t,lastUpdateId:"mapLastUpdate-"+t,fullScreenId:"mapFull-"+t,download:!1,type:n(),title_name:l(),lastUpdate:d(),timeInterval:o()}}(e),(a=new Map(i)).createWidget(),a.createMap()):"TextValue"==t?(i=function(t){var e=$("#TextValue").find("#unit").val(),a=$("#TextValue").find("#rgb").val();return{itemId:"item-"+t,widgetId:"text-value"+t,lastUpdateId:"textValueLastUpdate-"+t,fullScreenId:"textValueFull-"+t,download:!1,type:n(),title_name:l(),lastUpdate:d(),timeInterval:o(),unit:e,rgb:a}}(e),(a=new TextValue(i)).createWidget(),a.createTextValue()):"TextBox"===t&&(i=function(t){var e=$("#text-box").find("#text-custom").val(),a=$("#text-box").find("#font-size").val();return{itemId:"item-"+t,widgetId:"text-"+t,type:n(),download:!1,title_name:null,lastUpdate:null,timeInterval:null,textbox:e,fontsize:a}}(e),(a=new TextBox(i)).createWidget(),a.createTextBox()),widgetList.push(a)},r=function(){$("#settingW").click(function(){clearInterval(i),$(this).hide(),$(".full-screen").hide(),$(".edit-widget").show(),$("#addW").show(),$("#saveW").show(),$("#cancelW").show(),a.enableMove(!0),a.enableResize(!0)}),$("#widget_type").change(function(){var t;$(".value_widget").hide(),t=n(),$(".value_widget").hide(),$("#default-value").show(),"MutiLine"===t?$("#MutiLine").show():"text-line"===t?$("#text-line").show():"Gauges"===t?$("#Gauges").show():"TextValue"===t?$("#TextValue").show():"TextBox"===t?($("#text-box").show(),$("#default-value").hide()):$("#form-input-widget").html("")}),$("#addW").unbind().click(function(){$("input[type=text]").val(""),$("#myModal").modal("show")}),$("#add-new-widget").unbind().click(function(){s()}),$("#saveW").unbind().click(function(){var e;$("#saveW").hide(),$("#addW").hide(),$("#cancelW").hide(),$("#settingW").show(),$(".full-screen").show(),$(".edit-widget").hide(),c(),e=_.map($(".grid-stack > .grid-stack-item:visible"),function(e){var a=(e=$(e)).data("_gridstack_node"),i=t.getWidgetById(a.id);return{x:a.x,y:a.y,width:a.width,height:a.height,widget:Widget.formateDataSave(i)}}),$.ajax({url:END_POINT+"company/static/dashboard",method:"PUT",data:{static_id:$("#static_id").html(),dashboard:JSON.stringify(e,null,"")},success:function(t){console.log(t)},error:function(t){console.log(t)}}),a.enableMove(!1),a.enableResize(!1)}),$("#cancelW").unbind().click(function(){$("#saveW").hide(),$("#addW").hide(),$(".edit-widget").hide(),$(".full-screen").show(),$("#cancelW").hide(),$("#settingW").show(),c(),a.enableMove(!1),a.enableResize(!1)}),$("#btn-add-value-Mutiline").unbind().click(function(){var t;t=$("#line_value_layout").html(),$("#Mutiline_value").append(t)}),$("#btn-detail-toggle ").unbind().click(function(){$("#top-header").slideToggle("fast"),$(this).toggleClass("flip")})},c=function(){i=setInterval(function(){widgetList.length>0&&u([].concat(widgetList))},1e3)},u=function(e){for(var a=0;a<e.length;a++){var i=e[a];i.updateData&&(t.diffTime(i.lastUpdate,i.timeInterval)>=i.timeInterval?i.updateData():i.liveData&&i.liveData())}};this.initDashboard=function(){(Datasource=new Datasources).initCreate(),r();$.ajax({url:END_POINT+"company/static/"+$("#static_id").html(),method:"GET",success:function(t){t.data&&(function(t){var e=null,a=null,i=null,n="";for(var l in t){var o=Math.floor(1e5+9e5*Math.random());e=null,a=t[l].widget,i=t[l],n=a.type,a.itemId="item-"+o,a.lastUpdate=d(),"MutiLine"===n?(a.widgetId="myChart_"+o,a.fullScreenId="myChartFull_"+o,a.lastUpdateId="myChartLastUpdate_"+o,(e=new MutiLine(a)).createWidget(i),e.createMutiLine()):"Gauges"===n?(a.textId="gauges-text-"+o,a.widgetId="gauges-"+o,a.lastUpdateId="gaugesLastUpdate-"+o,a.fullScreenId="gaugesFull-"+o,(e=new Gauges(a)).createWidget(i),e.createGages()):"text-line"===n?(a.widgetId="myChart_"+o,a.lastUpdateId="myChartLastUpdate_"+o,a.fullScreenId="myChartFull_"+o,(e=new ChartTextLine(a)).createWidget(i),e.createTextLine()):"Map"===n?(a.widgetId="map-"+o,a.lastUpdateId="mapLastUpdate_"+o,a.fullScreenId="mapFull-"+o,(e=new Map(a)).createWidget(i),e.createMap()):"TextValue"===n?(a.widgetId="text-value"+o,a.lastUpdateId="textValueLastUpdate"+o,a.fullScreenId="textValueFull-"+o,(e=new TextValue(a)).createWidget(i),e.createTextValue()):"TextBox"===n&&(a.widgetId="text-"+o,(e=new TextBox(a)).createWidget(i),e.createTextBox()),widgetList.push(e)}$(".edit-widget").hide()}(GridStackUI.Utils.sort(JSON.parse(t.data[0].dashboard))),$("#loading").remove(),c(),$(".grid-stack").gridstack(e),(a=$(".grid-stack").data("gridstack")).enableMove(!1),a.enableResize(!1))},error:function(t){console.log(t)}})}}return _createClass(t,null,[{key:"diffTime",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=new Date,a=new Date(t),i=(e.getTime()-a.getTime())/1e3;return Math.abs(Math.round(i))}},{key:"updateGridData",value:function(t){}},{key:"getWidgetById",value:function(t){return widgetList.find(function(e){return e.itemId==t})}}]),t}();$(document).ready(function(){$("#sidebarCollapse").click(),(new Dashboard).initDashboard(),$(".grid-stack").on("gsresizestop",function(t,e){var a=$(e),i=JSON.parse(a.data("_gridstack_data")),n=a.data("_gridstack_node"),l=i.type;if("Gauges"===l);else if("MutiLine"===l){t.target,a.find(".card-body").width(),a.find(".card-body").height();var o=a.find(".card-body");$(o).find("canvas")}else if("Map"===l){Dashboard.getWidgetById(n.id).myMap.invalidateSize()}})})},DuR2:function(t,e){var a;a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(a=window)}t.exports=a},t4zo:function(t,e,a){(function(a){var i,n,l;n=[],void 0===(l="function"==typeof(i=function(){"use strict";function e(t,e,a){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){o(i.response,e,a)},i.onerror=function(){console.error("could not download file")},i.send()}function i(t){var e=new XMLHttpRequest;return e.open("HEAD",t,!1),e.send(),200<=e.status&&299>=e.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(a){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,o=l.saveAs||"object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype?function(t,a,o){var d=l.URL||l.webkitURL,s=document.createElement("a");a=a||t.name||"download",s.download=a,s.rel="noopener","string"==typeof t?(s.href=t,s.origin===location.origin?n(s):i(s.href)?e(t,a,o):n(s,s.target="_blank")):(s.href=d.createObjectURL(t),setTimeout(function(){d.revokeObjectURL(s.href)},4e4),setTimeout(function(){n(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,a,l){if(a=a||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Depricated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,l),a);else if(i(t))e(t,a,l);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){n(o)})}}:function(t,a,i,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return e(t,a,i);var o="application/octet-stream"===t.type,d=/constructor/i.test(l.HTMLElement)||l.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||o&&d)&&"object"==typeof FileReader){var r=new FileReader;r.onloadend=function(){var t=r.result;t=s?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},r.readAsDataURL(t)}else{var c=l.URL||l.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}};l.saveAs=o.saveAs=o,void 0!==t&&(t.exports=o)})?i.apply(e,n):i)||(t.exports=l)}).call(e,a("DuR2"))}});