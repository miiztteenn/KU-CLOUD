!function(t){var e={};function i(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="http://localhost:8080/",i(i.s=0)}({0:function(t,e,i){t.exports=i("AG5F")},"0v0P":function(t,e,i){"use strict";i.d(e,"b",function(){return a}),i.d(e,"a",function(){return o});var a=function(t){return t.map(function(t){return Object.assign({},t)})},n=null,o={set:function(t){n=t.html();var e=t.attr("data-loading-text");t.html(e),t.prop("disabled",!0)},reset:function(t){t.html(n),t.prop("disabled",!1)}}},AG5F:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("0v0P"),n=i("t4zo"),o=i.n(n),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}();function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Chart.defaults.global.defaultFontFamily="'Poppins', 'Kanit', 'sans-serif'";var u="http://localhost:8000/api/",f=null,p=/([a-zA-Z0-9_]+)/g,v={MUTILINE:"MutiLine",TEXTLINE:"TextLine",RADER:"Rader",GAUGES:"Gauges",MAP:"Map",TEXTVALUE:"TextValue",TEXTBOX:"TextBox"},m=function t(e){var i=this;c(this,t),this.widget=e;var a=null;this.createModalEdit=function(t,e){null===a&&(a='<div class="modal fade" id="EditWidget">\n                                        <div class="modal-dialog modal-lg">\n                                            <div class="modal-content">\n                                                <div class="modal-header">\n                                                    <h5 class="modal-title">Edit Widget</h5>\n                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>\n                                                </div>\n\n                                                <div class="modal-body" id="form-edit-widget">     \n                                                </div>\n\n                                                <div class="modal-footer">\n                                                    <button type="button" id="btn-submit-edit-widget" class="btn btn-success btn-block">Save</button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>',$("body").append(a)),$("#form-edit-widget").html(t),$("#EditWidget").modal("show")},this.submitEditClick=function(t){$("#btn-submit-edit-widget").unbind().click(function(){t()})},this.closeModalEdit=function(){$("#EditWidget").modal("hide")},this.findTitleWidget=function(){return $("#"+i.widget.itemId).find(".title-widget")}},h=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),a=function(){i.submitEditClick(n)},n=function(){var t=$("#edit-title").val();$(i.findTitleWidget()).html(t),i.widget.title_name=t,i.closeModalEdit()};return i.initCreate=function(){i.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                            <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                        </div>',a),a(),$("#edit-title").val(t.title_name)},i}return s(e,m),e}(),g=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),a=function(){i.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val(),a=i.widget.itemId.replace("item-","unit_");$(i.findTitleWidget()).html(t),$("#"+a).html(e),i.widget.title_name=t,i.widget.unit=e,i.closeModalEdit()};return i.initCreate=function(){i.createModalEdit('<div id="edit-Gauges" class="edit-widget-form"> \n                            <div class="row">\n                                <div class="col-6">\n                                    <lable>Title</label>\n                                    <input type="text" class="form-control" id="edit-title"/>\n                                </div>\n                                <div class="col-6">\n                                    <lable>Unit</label>\n                                    <input type="text" class="form-control" id="edit-unit"/>\n                                </div>\n                            </div>\n                        </div>',a),a(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},i}return s(e,m),e}(),b=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),a=function(){i.submitEditClick(n)},n=function(){var t=$("#edit-title").val();$(i.findTitleWidget()).html(t),i.widget.title_name=t,i.closeModalEdit()};return i.initCreate=function(){i.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                            <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                        </div>',a),a(),$("#edit-title").val(t.title_name)},i}return s(e,m),e}(),y=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),a=function(){i.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val();$(i.findTitleWidget()).html(t),$("#"+i.widget.widgetId).next("span").html(e),i.widget.title_name=t,i.widget.unit=e,i.closeModalEdit()};return i.initCreate=function(){i.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                                <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                            <div class="col-6">\n                                <lable>Unit</label>\n                                <input type="text" class="form-control" id="edit-unit"/>\n                            </div>\n                        </div>',a),a(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},i}return s(e,m),e}(),w=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),a=function(){i.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val(),a=i.widget.itemId.replace("item-","unit_");$(i.findTitleWidget()).html(t),$("#"+a).html(e),i.widget.title_name=t,i.widget.unit=e,i.closeModalEdit()};return i.initCreate=function(){i.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                                <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                            <div class="col-6">\n                                <lable>Unit</label>\n                                <input type="text" class="form-control" id="edit-unit"/>\n                            </div>\n                        </div>',a),a(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},i}return s(e,m),e}(),x=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),a=function(){i.submitEditClick(n)},n=function(){$("#"+t.widgetId).html($("#edit-text-custom").val()),$("#"+t.widgetId).css({"font-size":$("#edit-font-size").val()+"px"}),t.textbox=$("#edit-text-custom").val(),t.fontsize=$("#edit-font-size").val(),i.closeModalEdit()};return i.initCreate=function(){i.createModalEdit('<div id = "edit-text-box" class="value_widget">\n                            <div class="row">\n                                <div class="col-6">\n                                    <label>Text</label>\n                                    <input type="text" id="edit-text-custom" class="form-control" />\n                                </div>\n                                <div class="col-6">\n                                    <label>Font Size (px)</label>\n                                    <input type="number" id="edit-font-size" class="form-control" />\n                                </div>\n                            </div>\n                        </div> ',a),a(),$("#edit-text-custom").val(t.textbox),$("#edit-font-size").val(t.fontsize)},i}return s(e,m),e}(),I=function(){function t(e){var i=this;c(this,t),this.itemId=e.itemId,this.widgetId=e.widgetId,this.datasource=e.datasource,this.type=e.type,this.lastUpdateId=e.lastUpdateId,this.title_name=e.title_name,this.lastUpdate=e.lastUpdate,this.timeInterval=e.timeInterval,this.wi=e.wi,this.download=e.download,this.updateLastUpdate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?(i.lastUpdate=new Date(t),$("#"+i.lastUpdateId).html(i.lastUpdate.toDateString()+" "+i.lastUpdate.toLocaleTimeString())):(i.lastUpdate=new Date,$("#"+i.lastUpdateId).html(i.lastUpdate.toDateString()+" "+i.lastUpdate.toLocaleTimeString()))};var a={cellHeight:80,verticalMargin:10,float:!1},n=[{x:0,y:0,width:6,height:7}],l=null,d=null,r=function(){$(".btn-delete-wi").unbind().click(function(){u($(this))}),$(".btn-edit-wi").unbind().click(function(){var t,e,i,a;t=$(this),e=$(t).attr("item"),i=j.getWidgetById(e),a=null,i.type===v.MUTILINE?a=new h(i):i.type===v.TEXTLINE?a=new w(i):i.type===v.GAUGES?a=new g(i):i.type===v.MAP?a=new b(i):i.type===v.TEXTVALUE?a=new y(i):i.type===v.TEXTBOX&&(a=new x(i)),a.initCreate()}),$(".btn-full-screen").unbind().click(function(){s($(this))}),$(".btn-download").unbind().click(function(){var t=j.getWidgetById($(this).attr("item")),e=document.getElementById(t.widgetId);html2canvas(e).then(function(t){o()(t.toDataURL(),"file-name.png")})})},s=function(t){var e=j.getWidgetById(t.attr("item"));$("#modal-full-screen").modal("show"),$("#content-widget").html(e.selectWiContentFull()),e.createFullWidget()},u=function(t){null===d&&(d='\n                <div class="modal fade" id="DeleteWidget">\n                    <div class="modal-dialog modal-dialog-centered">\n                        <div class="modal-content">\n                            <div class="modal-header">\n                                <h5 class="modal-title">Delete Widget</h5>\n                                <button type="button" class="close" data-dismiss="modal">&times;</button>\n                            </div>\n    \n                            <div class="modal-body">\n                                <h6>Are you sure to delete this widget?</h6>\n                            </div>\n    \n                            <div class="modal-footer">\n                                <button type="button" id="" class="btn btn-danger btn-block btn-submit-delete-widget">Delete</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>',$("body").append(d)),$("#DeleteWidget").modal("show"),$(".btn-submit-delete-widget").unbind().click(function(){f($(t)),$("#DeleteWidget").modal("hide")})},f=function(t){var e=$(t).attr("item");l.removeWidget($("#"+e).closest(".grid-stack-item"));var i=O.findIndex(function(t){return t.itemId==e});O.splice(i,1)};this.selectWiContent=function(){switch(i.type){case v.MUTILINE:return'<canvas id="'+i.widgetId+'"></canvas>';case v.TEXTLINE:return' <h2 class="text-left"><span id="'+i.itemId.replace("item-","value_")+'">0</span> <span  id="'+i.itemId.replace("item-","unit_")+'">'+i.unit+'</span></h2>\n                             <canvas id="'+i.widgetId+'"></canvas>\n                            ';case v.GAUGES:return i.itemId.replace("item-","gauges-text-"),i.itemId.replace("item-","unit_"),'\n                            <div id="'+i.widgetId+'"></div>\n                            ';case v.MAP:return'\n                            <div id="'+i.widgetId+'"></div>\n                            ';case v.TEXTVALUE:return'\n                            <h1 style="color:'+i.rgb+'"><span id="'+i.widgetId+'">0</span> <span>'+i.unit+"</span><h1>\n                            ";case v.TEXTBOX:return'<span id="'+i.widgetId+'"></span>'}},this.selectWiContentFull=function(){switch(i.type){case"MutiLine":return'<canvas id="'+i.fullScreenId+'"></canvas>';case"text-line":return' <h2 class="text-left"><span id="'+i.itemId.replace("item-","value_full")+'">0</span> '+i.unit+'</h2>\n                             <canvas id="'+i.fullScreenId+'"></canvas>\n                            ';case"Gauges":return'\n                            <h2><span id="'+i.itemId.replace("item-","gauges-text-full")+'">0</span> <span>'+i.unit+'</span></h2>\n                            <canvas id="'+i.fullScreenId+'"></canvas>\n                            ';case"Map":return'\n                            <div id="'+i.fullScreenId+'"></div>\n                            '}},this.createWidget=function(){var t,e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=Math.floor(1e5+9e5*Math.random()),e=i.type.toLowerCase(),i.itemId="item-"+t,i.widgetId=e+"-"+t,i.lastUpdateId=e+"-lastupdate-"+t;var d=n.pop()||{x:3,y:4,width:6,height:7};$(".grid-stack").gridstack(a),l=$(".grid-stack").data("gridstack");var s="";"TextBox"!==i.type?(s=$("#layout-widget").html(),"TextValue"===i.type&&(d.width=4,d.height=4,s=$("#layout-widget-text-value").html()),s=(s=(s=(s=(s=s.replace(/div_id/g,i.itemId)).replace(/widget_id/g,i.widgetId)).replace("((wi))",i.selectWiContent())).replace("((title_name))",i.title_name)).replace("{last_update}",i.lastUpdateId)):(d.width=6,d.height=1,s=(s=(s=$("#layout-widget-text").html()).replace(/div_id/g,i.itemId)).replace("((wi))",i.selectWiContent())),d.id=i.itemId;var c,u,f=null;f=o?l.addWidget($(s),o.x,o.y,o.width,o.height,!0,null,null,null,null,d.id):l.addWidget($(s),d.x,d.y,d.width,d.height,!0,null,null,null,null,d.id),i.download||f.find(".full-screen").find(".btn-download").remove(),f.data("_gridstack_data",JSON.stringify((u={type:(c=i).type,datasource:c.datasource,timeInterval:c.timeInterval},c.type===v.MUTILINE?(u.title_name=c.title_name,u.datasets=c.datasets):c.type===v.TEXTLINE?(u.title_name=c.title_name,u.unit=c.unit,u.rgb=c.rgb):c.type===v.GAUGES?(u.title_name=c.title_name,u.opts=c.opts,u.limitMin=c.limitMin,u.limitMax=c.limitMax,u.unit=c.unit):c.type===v.MAP?u.title_name=c.title_name:c.type===v.TEXTLINE?(u.title_name=c.title_name,u.unit=c.unit,u.rgb=c.rgb):c.type===v.TEXTBOX&&(u.textbox=c.textbox,u.fontsize=c.fontsize),u))),r()}}return d(t,null,[{key:"formateDataSave",value:function(t){var e={type:t.type,datasource:t.datasource,download:!!t.download&&t.download,timeInterval:t.timeInterval};return"MutiLine"===t.type?(e.title_name=t.title_name,e.datasets=t.datasets):"text-line"===t.type?(e.title_name=t.title_name,e.unit=t.unit,e.rgb=t.rgb):"Gauges"===t.type?(e.title_name=t.title_name,e.opts=t.opts,e.limitMin=t.limitMin,e.limitMax=t.limitMax,e.unit=t.unit):"Map"===t.type?e.title_name=t.title_name:"TextValue"===t.type?(e.title_name=t.title_name,e.unit=t.unit,e.rgb=t.rgb):"TextBox"===t.type&&(e.textbox=t.textbox,e.fontsize=t.fontsize),e}}]),t}(),T=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));i.fullScreenId=t.fullScreenId,i.chart=null,i.datasets=t.datasets;var n={maintainAspectRatio:!1,scales:{yAxes:[{gridLines:{display:!1},ticks:{beginAtZero:!0,fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontStyle:"bold"}}],xAxes:[{gridLines:{display:!1},ticks:{fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontStyle:"bold"}}]},legend:{labels:{fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontColor:"black"}}};return i.createMutiLine=function(){var t=document.getElementById(i.widgetId),e=new Chart(t,{type:"line",data:{datasets:Object(a.b)(i.datasets)},options:n});i.chart=e},i.createFullWidget=function(){var t=document.getElementById(i.fullScreenId);new Chart(t,{type:"line",data:{datasets:Object(a.b)(i.datasets)},options:n})},i.updateData=function(){var t=i.chart,e=new Date;t.data.labels.push(e.toLocaleTimeString());var a=0;t.data.datasets.forEach(function(t){t.data.length>10&&t.data.splice(0,1),t.data.push(f.fatoryGetDatasourceValue(i.datasource[a],i.datasource[a][1])),a++}),t.data.labels.length>10&&t.data.labels.splice(0,1),t.update(),i.updateLastUpdate()},i}return s(e,I),e}(),E=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));i.fullScreenId=t.fullScreenId,i.unit=t.unit,i.rgb=t.rgb;var a={maintainAspectRatio:!1,responsive:!0,scales:{yAxes:[{display:!1}],xAxes:[{display:!1}]},legend:{display:!1},elements:{point:{radius:0},line:{tension:0}},layout:{padding:{left:0,right:0,top:0,bottom:30}},stepsize:100};return i.createTextLine=function(){var t=document.getElementById(i.widgetId),e=new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:["rgba(255, 255, 255, 0)"],borderColor:[i.rgb],borderWidth:2}]},options:a});return i.chart=e,i.updateData(),e},i.createFullWidget=function(){var t=document.getElementById(i.fullScreenId);new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:["rgba(255, 255, 255, 0)"],borderColor:[i.rgb],borderWidth:2}]},options:a})},i.updateData=function(){var t=i.widgetId;t=t.replace("myChart_","value_");var e=i.chart,a=Math.floor(100+900*Math.random()),n=new Date;e.data.labels.push(n.toLocaleTimeString()),e.data.datasets.forEach(function(e){e.data.length>10&&e.data.splice(0,1),e.data.push(a),$("#"+t).html(a)}),e.data.labels.length>10&&e.data.labels.splice(0,1),e.update(),i.updateLastUpdate()},i.liveData=function(){var t=i.widgetId;t=t.replace("myChart_","value_");var e=i.chart,a=new Date;e.data.labels.push(a.toLocaleTimeString()),e.data.datasets.forEach(function(t){t.data.length>10&&t.data.splice(0,1);var e=t.data[t.data.length-1];t.data.push(e)}),e.data.labels.length>10&&e.data.labels.splice(0,1),e.update()},i}return s(e,T),e}(),M=(function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.data=t.data,i}s(e,I)}(),function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.fullScreenId=t.fullScreenId,i.textId=t.textId,i.gaugeWidget=null,i.opts=t.opts,i.limitMax=t.limitMax?t.limitMax:100,i.limitMin=t.limitMin?t.limitMin:0,i.unit=t.unit,i.createGages=function(){i.gaugeWidget=new JustGage({id:i.widgetId,value:0,min:i.limitMin,max:i.limitMax,symbol:" "+i.unit,relativeGaugeSize:!0,titlePosition:"below"}),$("#"+i.widgetId).height($("#"+i.widgetId).height()-5),$("#"+i.widgetId).addClass("container")},i.updateData=function(){i.gaugeWidget.refresh(f.fatoryGetDatasourceValue(i.datasource[0],i.datasource[0][1])),i.updateLastUpdate()},i}return s(e,I),e}()),S=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.fullScreenId=t.fullScreenId,i.myMap=null,i.createMap=function(){var t=void 0,e=i.widgetId,a=$("#"+i.itemId).height()-100;$("#"+e).css("height",a),$("#"+e).css("width","auto"),t=L.map(e,{dragging:!0,zoomControl:!0,scrollWheelZoom:!1,zoomAnimation:!1}),$.getJSON("https://raw.githubusercontent.com/apisit/thailand.json/master/thailand.json").then(function(e){var i=new L.TileLayer.BoundaryCanvas("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{boundary:e,minZoom:5,maxZoom:9,attribution:"&copy; Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"});t.addLayer(i);var a=L.geoJSON(e);t.fitBounds(a.getBounds())}).then(function(){setTimeout(function(){t.invalidateSize(!0),$.ajax({dataType:"json",url:"/js/company/test-api.json",async:!1,success:function(e){var i=[],a=e.WeatherForecasts;for(var n in a)L.marker([a[n].location.lat,a[n].location.lon]).addTo(t).bindPopup(a[n].location.province+" อ ุณหภูมิที่ระดับพื้นผิว : "+a[n].forecasts[1].data.tc+" °C"),i.push([a[n].location.lat,a[n].location.lon,a[n].forecasts[1].data.tc/100]);L.heatLayer(i,{radius:75}).addTo(t)}})},1e3)}),$(".grid-stack").on("change",function(e,i){null!=t&&t.invalidateSize(!0)}),i.myMap=t,console.log(i.myMap)},i.createFullWidget=function(){var t=void 0,e=i.fullScreenId;$("#"+e).css("height","450px"),$("#"+e).css("width","auto"),t=L.map(e,{dragging:!0,zoomControl:!0,scrollWheelZoom:!1,zoomAnimation:!1}),$.getJSON("https://raw.githubusercontent.com/apisit/thailand.json/master/thailand.json").then(function(e){var i=new L.TileLayer.BoundaryCanvas("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{boundary:e,minZoom:5,maxZoom:9,attribution:"&copy; Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"});t.addLayer(i);var a=L.geoJSON(e);t.fitBounds(a.getBounds())}).then(function(){setTimeout(function(){t.invalidateSize(!0),$.ajax({dataType:"json",url:"/js/company/test-api.json",async:!1,success:function(e){var i=[],a=e.WeatherForecasts;for(var n in a)L.marker([a[n].location.lat,a[n].location.lon]).addTo(t).bindPopup(a[n].location.province+" อ ุณหภูมิที่ระดับพื้นผิว : "+a[n].forecasts[1].data.tc+" °C"),i.push([a[n].location.lat,a[n].location.lon,a[n].forecasts[1].data.tc/100]);L.heatLayer(i,{radius:75}).addTo(t)}})},1e3)})},i}return s(e,I),e}(),W=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.textValue=t.textValue,i.unit=t.unit,i.rgb=t.rgb,i.createTextValue=function(){},i.updateData=function(){var t=f.fatoryGetDatasourceValue(i.datasource[0],i.datasource[0][1]);$("#"+i.widgetId).html(t),i.updateLastUpdate()},i}return s(e,I),e}(),k=function(t){function e(t){c(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.textbox=t.textbox,i.fontsize=t.fontsize,i.createTextBox=function(){console.log($("#"+i.widgetId)),$("#"+i.widgetId).html(i.textbox),$("#"+i.widgetId).css({"font-size":i.fontsize+"px"})},i}return s(e,I),e}(),O=[],U=function t(){var e=this;c(this,t);var i=null,a=[],n=[],o=[],d=function(){$.ajax({url:u+"company/staticDatasource",method:"GET",data:{static_id:$("#static_id").html()},success:function(t){i=t.data,r()},error:function(t){console.log(t)}})},r=function(){$("#list-datasource").empty(),$(".select-datasource").empty();var t="<h5>Datasource</h5>",e="<option value=''>--Select datasource--</option>";i.map(function(i,a){t+='<div class="row">\n                            <div class="col-2 edit-datasource" title="Edit" index='+a+' style="cursor:pointer"> \n                                '+i.name+'\n                            </div>\n                            <div class="col-2 unActiveApi" id="datasource-isActive-'+a+'">\n                                <b>Not active</b>\n                            </div>\n                            <div class="col-3" id="datasource-'+a+'">\n\n                            </div>\n                        </div>',e+="<option value='"+i.id+"'>"+i.name+"</option>",f(a)}),setInterval(function(){s()},1e3),$(".select-datasource").html(e),$("#list-datasource").html(t)},s=function(){i.map(function(t,e){j.diffTime(t.lastUpdate,t.timeInterval)>=t.timeInterval&&f(e)})},f=function(t){var e=i[t].URL,n=i[t].name;$.ajax({url:e,success:function(e){var o=new Date;i[t].lastUpdate=o,$("#datasource-"+t).html(o.toDateString()+" "+o.toLocaleTimeString()),$("#datasource-isActive-"+t).html("<b>Active</b>"),$("#datasource-isActive-"+t).removeClass("unActiveApi"),$("#datasource-isActive-"+t).addClass("activeApi"),a[n]=e},error:function(t){console.log(t)}})},v=function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{n=e.match(p);var o=function t(e,i){if("object"==(void 0===i?"undefined":l(i)))return e==n.length?[Object.keys(i),i]:t(e+1,i[n[e]])}(2,a[n[1]]);$(i).parent().find("#data-list").empty(),console.log(o),o[0].map(function(t){$(i).parent().find("#data-list").append('<li class="value-data list-group-item" style="cursor:pointer" value="'+t+'">'+t+" : "+o[1][t]+"</li>")})}catch(t){}$(".value-data").unbind().click(function(){var e=$(this).parent().parent().find(".value-datasource"),i=$(e).val();i+="['"+$(this).attr("value")+"']",$(e).val(i),t($(e).val(),e)})};this.setDataAccess=function(t){o=t},this.getDatasourceValue=function(t,i){return"object"==l(i[o[t]])?e.getDatasourceValue(t+1,i[o[t]]):i[o[t]]},this.fatoryGetDatasourceValue=function(t,i){try{return o=t,e.getDatasourceValue(2,a[i])}catch(t){}},this.getDatasources=function(){return a};var m=function(){$("#btn-add-datasource").unbind().click(function(){$("#addDatasource").modal("show")}),$("#btn-add-new-datasource").unbind().click(function(){$.ajax({url:u+"company/static/datasource",method:"POST",data:{static_id:$("#static_id").html(),name:$("#name_datasource").val(),webservice_id:$("#webservice_id").val(),timeInterval:$("#add-data-time-interval").val()},success:function(t){d(),$("#addDatasource").modal("hide")},error:function(t){console.log(t)}})}),$("#addWidget").on("change",".select-datasource",function(){if($(this).parent().next().find(".value-datasource").val(""),$(this).parent().next().find("#data-list").empty(),""!=$(this).val()){var t=(e=$(this).val(),i.find(function(t){return t.id==e}));$(this).parent().next().find(".value-datasource").focus(),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;$(e).parent().find("#data-list").empty();var i="datasources['"+t+"']";$(e).val(i),v(i,e)}(t.name,$(this).parent().next().find(".value-datasource"))}var e}),$("#addWidget").on("change",".value-datasource",function(){v($(this).val(),$(this))})};this.initCreate=function(){m(),$.ajax({url:u+"company/webservices",success:function(t){(i=t.data).map(function(t){$("#webservice_id").append('<option value="'+t.webservice_id+'">'+t.service_name+"</option>")})},error:function(t){console.log(t)}}),d()}},j=function(){function t(){c(this,t);var e={cellHeight:80,verticalMargin:10,float:!1},i=null,a=null,n=function(){return $("#widget_type").val()},o=function(){return $("#title-name").val()},l=function(){return $("#time-interval").val()},d=function(){return(new Date).toUTCString()},r=function(){var t,e,i=n(),a=Math.floor(1e5+9e5*Math.random()),r=null,s=null;i===v.MUTILINE?(s=function(t){var e=$("#Mutiline_value").find(".label-y-chart-line").length,i=[];$("#Mutiline_value").find(".value-datasource:visible").each(function(){i.push($(this).val().match(p))});for(var a=[],r=0;r<e;r++){var s,c=$("#Mutiline_value").find(".label-y-chart-line"),u=$("#Mutiline_value").find(".rgb-chart-line");s={label:$(c[r]).val(),backgroundColor:"rgba(255,255,255,0.0)",borderColor:$(u[r]).val(),borderWidth:2},a.push(s)}return{datasource:i,fullScreenId:"myChartFull_"+t,download:!0,type:n(),title_name:o(),lastUpdate:d(),timeInterval:l(),datasets:[].concat(a)}}(a),(r=new T(Object.assign({},s))).createWidget(),r.createMutiLine()):i===v.TEXTLINE?(s=function(t){var e=$("#text-line").find("#unit").val(),i=$("#value-text-line").find("#rgb").val();return{datasource:[$("#text-line").find(".value-datasource").val().match(p)],fullScreenId:"myChartFull_"+t,download:!0,type:n(),title_name:o(),lastUpdate:d(),timeInterval:l(),rgb:i,unit:e}}(a),(r=new E(s)).createWidget(),r.createTextLine()):i===v.GAUGES?(s=function(t){var e=$("#Gauges").find("#g_limitMin").val(),i=$("#Gauges").find("#g_limitMax").val(),a=$("#Gauges").find("#unit").val();return{textId:"gauges-text-"+t,datasource:[$("#Gauges").find(".value-datasource").val().match(p)],fullScreenId:"gaugesFull-"+t,download:!0,type:n(),title_name:o(),lastUpdate:d(),timeInterval:l(),limitMax:i,limitMin:e,unit:a,opts:{angle:0,lineWidth:.23,radiusScale:1,pointer:{length:.6,strokeWidth:.035,color:"#000000"},limitMax:!1,limitMin:!1,colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:!0,highDpiSupport:!0,staticLabels:{font:"10px Poppins",labels:[0,Number(i)],color:"#000000",fractionDigits:0}}}}(a),(r=new M(s)).createWidget(),r.createGages()):i===v.MAP?(s=function(t){return{fullScreenId:"mapFull-"+t,download:!1,type:n(),title_name:o(),lastUpdate:d(),timeInterval:l()}}(a),(r=new S(s)).createWidget(),r.createMap()):i===v.TEXTVALUE?(s=function(t){var e=$("#TextValue").find("#unit").val(),i=$("#TextValue").find("#rgb").val();return{datasource:[$("#TextValue").find(".value-datasource").val().match(p)],fullScreenId:"textValueFull-"+t,download:!1,type:n(),title_name:o(),lastUpdate:d(),timeInterval:l(),unit:e,rgb:i}}(a),(r=new W(s)).createWidget(),r.createTextValue()):i===v.TEXTBOX&&(t=$("#text-box").find("#text-custom").val(),e=$("#text-box").find("#font-size").val(),s={type:n(),download:!1,title_name:null,lastUpdate:null,timeInterval:null,textbox:t,fontsize:e},(r=new k(s)).createWidget(),r.createTextBox()),O.push(r)},s=function(){$("#settingW").click(function(){clearInterval(a),$(this).hide(),$(".full-screen").hide(),$(".edit-widget").show(),$("#addW").show(),$("#saveW").show(),$("#cancelW").show(),i.enableMove(!0),i.enableResize(!0)}),$("#widget_type").change(function(){var t;$(".value_widget").hide(),t=n(),$(".value_widget").hide(),$("#default-value").show(),"MutiLine"===t?$("#MutiLine").show():"text-line"===t?$("#text-line").show():"Gauges"===t?$("#Gauges").show():"TextValue"===t?$("#TextValue").show():"TextBox"===t?($("#text-box").show(),$("#default-value").hide()):$("#form-input-widget").html("")}),$("#addW").unbind().click(function(){$("input[type=text]").val(""),$("#addWidget").modal("show")}),$("#add-new-widget").unbind().click(function(){r()}),$("#saveW").unbind().click(function(){var e;$("#saveW").hide(),$("#addW").hide(),$("#cancelW").hide(),$("#settingW").show(),$(".full-screen").show(),$(".edit-widget").hide(),m(),e=_.map($(".grid-stack > .grid-stack-item:visible"),function(e){var i=(e=$(e)).data("_gridstack_node"),a=t.getWidgetById(i.id);return{x:i.x,y:i.y,width:i.width,height:i.height,widget:I.formateDataSave(a)}}),$.ajax({url:u+"company/static/dashboard",method:"PUT",data:{static_id:$("#static_id").html(),dashboard:JSON.stringify(e,null,"")},success:function(t){console.log(t)},error:function(t){console.log(t)}}),i.enableMove(!1),i.enableResize(!1)}),$("#cancelW").unbind().click(function(){$("#saveW").hide(),$("#addW").hide(),$(".edit-widget").hide(),$(".full-screen").show(),$("#cancelW").hide(),$("#settingW").show(),m(),i.enableMove(!1),i.enableResize(!1)}),$("#btn-add-value-Mutiline").unbind().click(function(){var t;t=$("#line_value_layout").html(),$("#Mutiline_value").append(t)}),$("#btn-detail-toggle ").unbind().click(function(){$("#top-header").slideToggle("fast"),$(this).toggleClass("flip")}),$("#addWidget").on("click",".remove-value",function(){$(this).parent().parent().remove()})},m=function(){a=setInterval(function(){O.length>0&&h([].concat(O))},1e3)},h=function(e){for(var i=0;i<e.length;i++){var a=e[i];a.updateData&&(t.diffTime(a.lastUpdate,a.timeInterval)>=a.timeInterval?a.updateData():a.liveData&&a.liveData())}};this.initDashboard=function(){f=new U,s();$.ajax({url:u+"company/static/"+$("#static_id").html(),method:"GET",success:function(t){t.data&&(function(t){var e=null,i=null,a=null,n="";for(var o in t)e=null,i=t[o].widget,a=t[o],n=i.type,i.lastUpdate=d(),n===v.MUTILINE?((e=new T(i)).createWidget(a),e.createMutiLine()):n===v.GAUGES?((e=new M(i)).createWidget(a),e.createGages()):n===v.TEXTLINE?((e=new E(i)).createWidget(a),e.createTextLine()):n===v.MAP?((e=new S(i)).createWidget(a),e.createMap()):n===v.TEXTVALUE?((e=new W(i)).createWidget(a),e.createTextValue()):n===v.TEXTBOX&&((e=new k(i)).createWidget(a),e.createTextBox()),O.push(e);$(".edit-widget").hide()}(GridStackUI.Utils.sort(JSON.parse(t.data[0].dashboard))),$("#loading").remove(),m(),$(".grid-stack").gridstack(e),(i=$(".grid-stack").data("gridstack")).enableMove(!1),i.enableResize(!1),f.initCreate())},error:function(t){console.log(t)}})}}return d(t,null,[{key:"diffTime",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=new Date,i=new Date(t),a=(e.getTime()-i.getTime())/1e3;return Math.abs(Math.round(a))}},{key:"updateGridData",value:function(t){}},{key:"getWidgetById",value:function(t){return O.find(function(e){return e.itemId==t})}}]),t}();$(document).ready(function(){$("#sidebarCollapse").click(),(new j).initDashboard(),$(".grid-stack").on("gsresizestop",function(t,e){var i=$(e),a=JSON.parse(i.data("_gridstack_data")),n=i.data("_gridstack_node"),o=a.type;if("Gauges"===o);else if("MutiLine"===o){t.target,i.find(".card-body").width(),i.find(".card-body").height();var l=i.find(".card-body");$(l).find("canvas")}else if("Map"===o){j.getWidgetById(n.id).myMap.invalidateSize()}})})},DuR2:function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},t4zo:function(t,e,i){(function(i){var a,n,o;n=[],void 0===(o="function"==typeof(a=function(){"use strict";function e(t,e,i){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){l(a.response,e,i)},a.onerror=function(){console.error("could not download file")},a.send()}function a(t){var e=new XMLHttpRequest;return e.open("HEAD",t,!1),e.send(),200<=e.status&&299>=e.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof i&&i.global===i?i:void 0,l=o.saveAs||"object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(t,i,l){var d=o.URL||o.webkitURL,r=document.createElement("a");i=i||t.name||"download",r.download=i,r.rel="noopener","string"==typeof t?(r.href=t,r.origin===location.origin?n(r):a(r.href)?e(t,i,l):n(r,r.target="_blank")):(r.href=d.createObjectURL(t),setTimeout(function(){d.revokeObjectURL(r.href)},4e4),setTimeout(function(){n(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,i,o){if(i=i||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Depricated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,o),i);else if(a(t))e(t,i,o);else{var l=document.createElement("a");l.href=t,l.target="_blank",setTimeout(function(){n(l)})}}:function(t,i,a,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return e(t,i,a);var l="application/octet-stream"===t.type,d=/constructor/i.test(o.HTMLElement)||o.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||l&&d)&&"object"==typeof FileReader){var s=new FileReader;s.onloadend=function(){var t=s.result;t=r?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},s.readAsDataURL(t)}else{var c=o.URL||o.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}};o.saveAs=l.saveAs=l,void 0!==t&&(t.exports=l)})?a.apply(e,n):a)||(t.exports=o)}).call(e,i("DuR2"))}});