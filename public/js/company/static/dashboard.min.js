!function(t){var e={};function a(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="http://localhost:8080/",a(a.s=0)}({0:function(t,e,a){t.exports=a("AG5F")},"0v0P":function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"b",function(){return n}),a.d(e,"a",function(){return o});var i=function(t){return t.map(function(t){return Object.assign({},t)})},n=function(t,e){return t=t.replace("#",""),"rgba("+parseInt(t.substring(0,2),16)+","+parseInt(t.substring(2,4),16)+","+parseInt(t.substring(4,6),16)+","+e/100+")"},l=null,o={set:function(t){l=t.html();var e=t.attr("data-loading-text");t.html(e),t.prop("disabled",!0)},reset:function(t){t.html(l),t.prop("disabled",!1)}}},AG5F:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("0v0P"),n=a("t4zo"),l=a.n(n),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}();function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Chart.defaults.global.defaultFontFamily="'Poppins', 'Kanit', 'sans-serif'";var u="http://localhost:8000/api/",p=null,f=/([a-zA-Z0-9_]+)/g,v={MUTILINE:"MutiLine",TEXTLINE:"TextLine",RADAR:"Radar",GAUGES:"Gauges",MAP:"Map",TEXTVALUE:"TextValue",TABEL:"TABEL",TEXTBOX:"TextBox"},h=null,m=function t(e){var a=this;c(this,t),this.widget=e;var i=null;this.createModalEdit=function(t,e){null===i&&(i='<div class="modal fade" id="EditWidget">\n                                        <div class="modal-dialog modal-lg">\n                                            <div class="modal-content">\n                                                <div class="modal-header">\n                                                    <h5 class="modal-title">Edit Widget</h5>\n                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>\n                                                </div>\n\n                                                <div class="modal-body" id="form-edit-widget">     \n                                                </div>\n\n                                                <div class="modal-footer">\n                                                    <button type="button" id="btn-submit-edit-widget" class="btn btn-success btn-block">Save</button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>',$("body").append(i)),$("#form-edit-widget").html(t),$("#EditWidget").modal("show")},this.submitEditClick=function(t){$("#btn-submit-edit-widget").unbind().click(function(){t()})},this.closeModalEdit=function(){$("#EditWidget").modal("hide")},this.findTitleWidget=function(){return $("#"+a.widget.itemId).find(".title-widget")}},g=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val();$(a.findTitleWidget()).html(t),a.widget.title_name=t,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                            <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name)},a}return s(e,m),e}(),b=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val(),i=a.widget.itemId.replace("item-","unit_");$(a.findTitleWidget()).html(t),$("#"+i).html(e),a.widget.title_name=t,a.widget.unit=e,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div id="edit-Gauges" class="edit-widget-form"> \n                            <div class="row">\n                                <div class="col-6">\n                                    <lable>Title</label>\n                                    <input type="text" class="form-control" id="edit-title"/>\n                                </div>\n                                <div class="col-6">\n                                    <lable>Unit</label>\n                                    <input type="text" class="form-control" id="edit-unit"/>\n                                </div>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},a}return s(e,m),e}(),y=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val();$(a.findTitleWidget()).html(t),a.widget.title_name=t,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                            <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name)},a}return s(e,m),e}(),w=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val();$(a.findTitleWidget()).html(t),$("#"+a.widget.widgetId).next("span").html(e),a.widget.title_name=t,a.widget.unit=e,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                                <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                            <div class="col-6">\n                                <lable>Unit</label>\n                                <input type="text" class="form-control" id="edit-unit"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},a}return s(e,m),e}(),x=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){var t=$("#edit-title").val(),e=$("#edit-unit").val(),i=a.widget.itemId.replace("item-","unit_");$(a.findTitleWidget()).html(t),$("#"+i).html(e),a.widget.title_name=t,a.widget.unit=e,a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div class="row" id="div-title">\n                            <div class="col-6">\n                                <lable>Title</label>\n                                <input type="text" class="form-control" id="edit-title"/>\n                            </div>\n                            <div class="col-6">\n                                <lable>Unit</label>\n                                <input type="text" class="form-control" id="edit-unit"/>\n                            </div>\n                        </div>',i),i(),$("#edit-title").val(t.title_name),$("#edit-unit").val(t.unit)},a}return s(e,m),e}(),I=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(){a.submitEditClick(n)},n=function(){$("#"+t.widgetId).html($("#edit-text-custom").val()),$("#"+t.widgetId).css({"font-size":$("#edit-font-size").val()+"px"}),t.textbox=$("#edit-text-custom").val(),t.fontsize=$("#edit-font-size").val(),a.closeModalEdit()};return a.initCreate=function(){a.createModalEdit('<div id = "edit-text-box" class="value_widget">\n                            <div class="row">\n                                <div class="col-6">\n                                    <label>Text</label>\n                                    <input type="text" id="edit-text-custom" class="form-control" />\n                                </div>\n                                <div class="col-6">\n                                    <label>Font Size (px)</label>\n                                    <input type="number" id="edit-font-size" class="form-control" />\n                                </div>\n                            </div>\n                        </div> ',i),i(),$("#edit-text-custom").val(t.textbox),$("#edit-font-size").val(t.fontsize)},a}return s(e,m),e}(),E=function(){function t(e){var a=this;c(this,t),this.itemId=e.itemId,this.widgetId=e.widgetId,this.datasource=e.datasource,this.type=e.type,this.lastUpdateId=e.lastUpdateId,this.title_name=e.title_name,this.lastUpdate=e.lastUpdate,this.timeInterval=e.timeInterval,this.wi=e.wi,this.download=e.download,this.updateLastUpdate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?(a.lastUpdate=new Date(t),$("#"+a.lastUpdateId).html(a.lastUpdate.toDateString()+" "+a.lastUpdate.toLocaleTimeString())):(a.lastUpdate=new Date,$("#"+a.lastUpdateId).html(a.lastUpdate.toDateString()+" "+a.lastUpdate.toLocaleTimeString()))};var i={cellHeight:80,verticalMargin:10,float:!1},n=[{x:0,y:0,width:6,height:7}],o=null,d=null,r=function(){$(".btn-delete-wi").unbind().click(function(){u($(this))}),$(".btn-edit-wi").unbind().click(function(){var t,e,a,i;t=$(this),e=$(t).attr("item"),a=D.getWidgetById(e),i=null,a.type===v.MUTILINE?i=new g(a):a.type===v.TEXTLINE?i=new x(a):a.type===v.GAUGES?i=new b(a):a.type===v.MAP?i=new y(a):a.type===v.TEXTVALUE?i=new w(a):a.type===v.TEXTBOX&&(i=new I(a)),i.initCreate()}),$(".btn-full-screen").unbind().click(function(){s($(this))}),$(".btn-download").unbind().click(function(){var t=D.getWidgetById($(this).attr("item")),e=document.getElementById(t.widgetId);html2canvas(e).then(function(t){l()(t.toDataURL(),"file-name.png")})})},s=function(t){var e=D.getWidgetById(t.attr("item"));$("#modal-full-screen").modal("show"),$("#content-widget").html(e.selectWiContentFull()),e.createFullWidget()},u=function(t){null===d&&(d='\n                <div class="modal fade" id="DeleteWidget">\n                    <div class="modal-dialog modal-dialog-centered">\n                        <div class="modal-content">\n                            <div class="modal-header">\n                                <h5 class="modal-title">Delete Widget</h5>\n                                <button type="button" class="close" data-dismiss="modal">&times;</button>\n                            </div>\n    \n                            <div class="modal-body">\n                                <h6>Are you sure to delete this widget?</h6>\n                            </div>\n    \n                            <div class="modal-footer">\n                                <button type="button" id="" class="btn btn-danger btn-block btn-submit-delete-widget">Delete</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>',$("body").append(d)),$("#DeleteWidget").modal("show"),$(".btn-submit-delete-widget").unbind().click(function(){p($(t)),$("#DeleteWidget").modal("hide")})},p=function(t){var e=$(t).attr("item");o.removeWidget($("#"+e).closest(".grid-stack-item"));var a=O.findIndex(function(t){return t.itemId==e});O.splice(a,1)};this.selectWiContent=function(){switch(a.type){case v.MUTILINE:return'<canvas id="'+a.widgetId+'"></canvas>';case v.TEXTLINE:return' <h2 class="text-left"><span id="'+a.itemId.replace("item-","value_")+'">0</span> <span  id="'+a.itemId.replace("item-","unit_")+'">'+a.unit+'</span></h2>\n                             <canvas id="'+a.widgetId+'"></canvas>\n                            ';case v.RADAR:return'<canvas id="'+a.widgetId+'"></canvas>';case v.GAUGES:return a.itemId.replace("item-","gauges-text-"),a.itemId.replace("item-","unit_"),'\n                            <div id="'+a.widgetId+'"></div>\n                            ';case v.MAP:return'\n                            <div id="'+a.widgetId+'"></div>\n                            ';case v.TEXTVALUE:return'\n                            <h1 style="color:'+a.rgb+'"><span id="'+a.widgetId+'">0</span> <span>'+a.unit+"</span><h1>\n                            ";case v.TEXTBOX:return'<span id="'+a.widgetId+'"></span>'}},this.selectWiContentFull=function(){switch(a.type){case v.MUTILINE:return'<canvas id="'+a.fullScreenId+'"></canvas>';case v.TEXTLINE:return' <h2 class="text-left"><span id="'+a.itemId.replace("item-","value_full")+'">0</span> '+a.unit+'</h2>\n                             <canvas id="'+a.fullScreenId+'"></canvas>\n                            ';case v.GAUGES:return'\n                            <h2><span id="'+a.itemId.replace("item-","gauges-text-full")+'">0</span> <span>'+a.unit+'</span></h2>\n                            <canvas id="'+a.fullScreenId+'"></canvas>\n                            ';case v.MAP:return'\n                            <div id="'+a.fullScreenId+'"></div>\n                            '}},this.createWidget=function(){var t,e,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=Math.floor(1e5+9e5*Math.random()),e=a.type.toLowerCase(),a.itemId="item-"+t,a.widgetId=e+"-"+t,a.lastUpdateId=e+"-lastupdate-"+t;var d=n.pop()||{x:3,y:4,width:6,height:7};$(".grid-stack").gridstack(i),o=$(".grid-stack").data("gridstack");var s="";"TextBox"!==a.type?(s=$("#layout-widget").html(),"TextValue"===a.type&&(d.width=4,d.height=4,s=$("#layout-widget-text-value").html()),s=(s=(s=(s=(s=s.replace(/div_id/g,a.itemId)).replace(/widget_id/g,a.widgetId)).replace("((wi))",a.selectWiContent())).replace("((title_name))",a.title_name)).replace("{last_update}",a.lastUpdateId)):(d.width=6,d.height=1,s=(s=(s=$("#layout-widget-text").html()).replace(/div_id/g,a.itemId)).replace("((wi))",a.selectWiContent())),d.id=a.itemId;var c,u,p=null;p=l?o.addWidget($(s),l.x,l.y,l.width,l.height,!0,null,null,null,null,d.id):o.addWidget($(s),d.x,d.y,d.width,d.height,!0,null,null,null,null,d.id),a.download||p.find(".full-screen").find(".btn-download").remove(),p.data("_gridstack_data",JSON.stringify((u={type:(c=a).type,datasource:c.datasource,timeInterval:c.timeInterval},c.type===v.MUTILINE?(u.title_name=c.title_name,u.datasets=c.datasets):c.type===v.TEXTLINE?(u.title_name=c.title_name,u.unit=c.unit,u.rgb=c.rgb):c.type===v.RADER||(c.type===v.GAUGES?(u.title_name=c.title_name,u.opts=c.opts,u.limitMin=c.limitMin,u.limitMax=c.limitMax,u.unit=c.unit):c.type===v.MAP?u.title_name=c.title_name:c.type===v.TEXTLINE?(u.title_name=c.title_name,u.unit=c.unit,u.rgb=c.rgb):c.type===v.TEXTBOX&&(u.textbox=c.textbox,u.fontsize=c.fontsize)),u))),r()}}return d(t,null,[{key:"formateDataSave",value:function(t){var e={type:t.type,datasource:t.datasource,download:!!t.download&&t.download,timeInterval:t.timeInterval};return t.type===v.MUTILINE?(e.title_name=t.title_name,e.datasets=t.datasets):t.type===v.TEXTLINE?(e.title_name=t.title_name,e.unit=t.unit,e.rgb=t.rgb):t.type===v.RADAR?(e.datasets=t.datasets,e.title_name=t.title_name,e.labels=t.labels,e.label=t.label,e.color=t.color):t.type===v.GAUGES?(e.title_name=t.title_name,e.opts=t.opts,e.limitMin=t.limitMin,e.limitMax=t.limitMax,e.unit=t.unit):t.type===v.MAP?e.title_name=t.title_name:t.type===v.TEXTVALUE?(e.title_name=t.title_name,e.unit=t.unit,e.rgb=t.rgb):t.type===v.TEXTBOX&&(e.textbox=t.textbox,e.fontsize=t.fontsize),e}}]),t}(),T=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.fullScreenId=t.fullScreenId,a.chart=null,a.datasets=t.datasets;var n={maintainAspectRatio:!1,scales:{yAxes:[{gridLines:{display:!1},ticks:{beginAtZero:!0,fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontStyle:"bold"}}],xAxes:[{gridLines:{display:!1},ticks:{fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontStyle:"bold"}}]},legend:{labels:{fontFamily:"'Poppins', 'Kanit', 'sans-serif'",fontColor:"black"}},tooltips:{mode:"nearest",intersect:!1},hover:{mode:"nearest",intersect:!1}};return a.createMutiLine=function(){var t=document.getElementById(a.widgetId),e=new Chart(t,{type:"line",data:{datasets:Object(i.c)(a.datasets)},options:n});a.chart=e},a.createFullWidget=function(){var t=document.getElementById(a.fullScreenId);new Chart(t,{type:"line",data:{datasets:Object(i.c)(a.datasets)},options:n})},a.updateData=function(){var t=a.chart,e=new Date;t.data.labels.push(e.toLocaleTimeString());var i=0;t.data.datasets.forEach(function(t){t.data.length>10&&t.data.splice(0,1),t.data.push(p.fatoryGetDatasourceValue(a.datasource[i],a.datasource[i][1])),i++}),t.data.labels.length>10&&t.data.labels.splice(0,1),t.update(),a.updateLastUpdate()},a}return s(e,E),e}(),M=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.fullScreenId=t.fullScreenId,a.unit=t.unit,a.rgb=t.rgb;var i={maintainAspectRatio:!1,responsive:!0,scales:{yAxes:[{display:!1}],xAxes:[{display:!1}]},legend:{display:!1},elements:{point:{radius:0},line:{tension:0}},layout:{padding:{left:0,right:0,top:0,bottom:30}},stepsize:100};return a.createTextLine=function(){var t=document.getElementById(a.widgetId),e=new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:["rgba(255, 255, 255, 0)"],borderColor:[a.rgb],borderWidth:2}]},options:i});return a.chart=e,a.updateData(),e},a.createFullWidget=function(){var t=document.getElementById(a.fullScreenId);new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:["rgba(255, 255, 255, 0)"],borderColor:[a.rgb],borderWidth:2}]},options:i})},a.updateData=function(){var t=a.widgetId;t=t.replace("myChart_","value_");var e=a.chart,i=Math.floor(100+900*Math.random()),n=new Date;e.data.labels.push(n.toLocaleTimeString()),e.data.datasets.forEach(function(e){e.data.length>10&&e.data.splice(0,1),e.data.push(i),$("#"+t).html(i)}),e.data.labels.length>10&&e.data.labels.splice(0,1),e.update(),a.updateLastUpdate()},a.liveData=function(){var t=a.widgetId;t=t.replace("myChart_","value_");var e=a.chart,i=new Date;e.data.labels.push(i.toLocaleTimeString()),e.data.datasets.forEach(function(t){t.data.length>10&&t.data.splice(0,1);var e=t.data[t.data.length-1];t.data.push(e)}),e.data.labels.length>10&&e.data.labels.splice(0,1),e.update()},a}return s(e,T),e}(),k=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.datasets=t.datasets,a.labels=t.labels,a.label=t.label,a.color=t.color,a.radar=null;var n={type:"radar",maintainAspectRatio:!1,data:{labels:[],datasets:[]},options:{legend:{position:"top"},title:{display:!0},scale:{ticks:{beginAtZero:!0}}}};return a.createRadar=function(){var t=document.getElementById(a.widgetId),e=new Chart(t,n),l=0;e.data.labels=a.labels,e.data.datasets=Object(i.c)(a.datasets),e.data.datasets.forEach(function(t){t.label=a.label[l],t.backgroundColor=Object(i.b)(a.color[l],20),t.borderColor=a.color[l],t.pointBackgroundColor=a.color[l],t.data=[],l++}),e.update(),a.radar=e},a.updateData=function(){var t=0;a.radar.data.datasets.forEach(function(e){e.data=[],a.radar.data.labels.map(function(i){e.data.push(p.fatoryGetDatasourceValue(a.datasource[t],a.datasource[t][1])),t++})}),a.radar.update(),a.updateLastUpdate()},a}return s(e,E),e}(),S=function t(){var e=this;c(this,t);var a={type:"radar",data:{labels:[],datasets:[]},options:{legend:{position:"top"},title:{display:!0},scale:{ticks:{beginAtZero:!0}}}};this.createRadarExample=function(){if(null===h){var t=document.getElementById("example-radar"),i=new Chart(t,a);h=i,e.updateRadarExample()}};this.updateRadarExample=function(){var t=[],e=[],a=[],n=[];Chart.helpers.color;$(".radar-labels:visible").each(function(){t.push($(this).val()),a.push(getRandomInt(0,50))}),h.data.labels=[],h.data.datasets=[],$(".label-radar:visible").each(function(){e.push($(this).val()),h.data.datasets.push({})}),$(".radar-color").each(function(){n.push($(this).val())});var l=0;h.data.labels=t,h.data.datasets.forEach(function(t){t.label=e[l],t.backgroundColor=Object(i.b)(n[l],20),t.borderColor=n[l],t.pointBackgroundColor=n[l],t.data=a,a=a.map(function(t){return t+getRandomInt(0,10)}),l++}),h.update()}},A=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.fullScreenId=t.fullScreenId,a.textId=t.textId,a.gaugeWidget=null,a.opts=t.opts,a.limitMax=t.limitMax?t.limitMax:100,a.limitMin=t.limitMin?t.limitMin:0,a.unit=t.unit,a.createGages=function(){a.gaugeWidget=new JustGage({id:a.widgetId,value:0,min:a.limitMin,max:a.limitMax,symbol:" "+a.unit,relativeGaugeSize:!0,titlePosition:"below"}),$("#"+a.widgetId).height($("#"+a.widgetId).height()-5),$("#"+a.widgetId).addClass("container")},a.updateData=function(){a.gaugeWidget.refresh(p.fatoryGetDatasourceValue(a.datasource[0],a.datasource[0][1])),a.updateLastUpdate()},a}return s(e,E),e}(),W=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.fullScreenId=t.fullScreenId,a.myMap=null,a.createMap=function(){var t=void 0,e=a.widgetId,i=$("#"+a.itemId).height()-100;$("#"+e).css("height",i),$("#"+e).css("width","auto"),t=L.map(e,{dragging:!0,zoomControl:!0,scrollWheelZoom:!1,zoomAnimation:!1}),$.getJSON("https://raw.githubusercontent.com/apisit/thailand.json/master/thailand.json").then(function(e){var a=new L.TileLayer.BoundaryCanvas("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{boundary:e,minZoom:5,maxZoom:9,attribution:"&copy; Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"});t.addLayer(a);var i=L.geoJSON(e);t.fitBounds(i.getBounds())}).then(function(){setTimeout(function(){t.invalidateSize(!0),$.ajax({dataType:"json",url:"/js/company/test-api.json",async:!1,success:function(e){var a=[],i=e.WeatherForecasts;for(var n in i)L.marker([i[n].location.lat,i[n].location.lon]).addTo(t).bindPopup(i[n].location.province+" อ ุณหภูมิที่ระดับพื้นผิว : "+i[n].forecasts[1].data.tc+" °C"),a.push([i[n].location.lat,i[n].location.lon,i[n].forecasts[1].data.tc/100]);L.heatLayer(a,{radius:75}).addTo(t)}})},1e3)}),$(".grid-stack").on("change",function(e,a){null!=t&&t.invalidateSize(!0)}),a.myMap=t,console.log(a.myMap)},a.createFullWidget=function(){var t=void 0,e=a.fullScreenId;$("#"+e).css("height","450px"),$("#"+e).css("width","auto"),t=L.map(e,{dragging:!0,zoomControl:!0,scrollWheelZoom:!1,zoomAnimation:!1}),$.getJSON("https://raw.githubusercontent.com/apisit/thailand.json/master/thailand.json").then(function(e){var a=new L.TileLayer.BoundaryCanvas("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{boundary:e,minZoom:5,maxZoom:9,attribution:"&copy; Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"});t.addLayer(a);var i=L.geoJSON(e);t.fitBounds(i.getBounds())}).then(function(){setTimeout(function(){t.invalidateSize(!0),$.ajax({dataType:"json",url:"/js/company/test-api.json",async:!1,success:function(e){var a=[],i=e.WeatherForecasts;for(var n in i)L.marker([i[n].location.lat,i[n].location.lon]).addTo(t).bindPopup(i[n].location.province+" อ ุณหภูมิที่ระดับพื้นผิว : "+i[n].forecasts[1].data.tc+" °C"),a.push([i[n].location.lat,i[n].location.lon,i[n].forecasts[1].data.tc/100]);L.heatLayer(a,{radius:75}).addTo(t)}})},1e3)})},a}return s(e,E),e}(),U=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.textValue=t.textValue,a.unit=t.unit,a.rgb=t.rgb,a.createTextValue=function(){},a.updateData=function(){var t=p.fatoryGetDatasourceValue(a.datasource[0],a.datasource[0][1]);$("#"+a.widgetId).html(t),a.updateLastUpdate()},a}return s(e,E),e}(),C=function(t){function e(t){c(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.textbox=t.textbox,a.fontsize=t.fontsize,a.createTextBox=function(){console.log($("#"+a.widgetId)),$("#"+a.widgetId).html(a.textbox),$("#"+a.widgetId).css({"font-size":a.fontsize+"px"})},a}return s(e,E),e}(),O=[],R=function t(){var e=this;c(this,t);var a=null,i=[],n=[],l=[],d=function(){$.ajax({url:u+"company/staticDatasource",method:"GET",data:{static_id:$("#static_id").html()},success:function(t){a=t.data,r()},error:function(t){console.log(t)}})},r=function(){$("#list-datasource").empty(),$(".select-datasource").empty();var t="<h5>Datasource</h5>",e="<option value=''>--Select datasource--</option>";a.map(function(a,i){t+='<div class="row">\n                            <div class="col-2 edit-datasource" title="Edit" index='+i+' style="cursor:pointer"> \n                                '+a.name+'\n                            </div>\n                            <div class="col-2 unActiveApi" id="datasource-isActive-'+i+'">\n                                <b>Not active</b>\n                            </div>\n                            <div class="col-3" id="datasource-'+i+'">\n\n                            </div>\n                        </div>',e+="<option value='"+a.id+"'>"+a.name+"</option>",p(i)}),setInterval(function(){s()},1e3),$(".select-datasource").html(e),$("#list-datasource").html(t)},s=function(){a.map(function(t,e){D.diffTime(t.lastUpdate,t.timeInterval)>=t.timeInterval&&p(e)})},p=function(t){a[t].URL;var e=a[t].name;$.ajax({url:"/js/company/test-api2.json",success:function(n){var l=new Date;a[t].lastUpdate=l,$("#datasource-"+t).html(l.toDateString()+" "+l.toLocaleTimeString()),$("#datasource-isActive-"+t).html("<b>Active</b>"),$("#datasource-isActive-"+t).removeClass("unActiveApi"),$("#datasource-isActive-"+t).addClass("activeApi"),i[e]=n},error:function(t){console.log(t)}})},v=function(t){return a.find(function(e){return e.id==t})},h=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;$(e).parent().find(".data-list").empty();var a="datasources['"+t+"']";$(e).val(a),m(a,e)},m=function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{n=e.match(f);var l=function t(e,a){if("object"==(void 0===a?"undefined":o(a)))return e==n.length?[Object.keys(a),a]:t(e+1,a[n[e]])}(2,i[n[1]]);$(a).parent().find(".data-list").empty(),l[0].map(function(t){$(a).parent().find(".data-list").append('<li class="value-data list-group-item" style="cursor:pointer" value="'+t+'">'+t+" : "+l[1][t]+"</li>")}),$(".data-list").scrollTop(0),n.length>2&&$(a).parent().find(".data-list").prepend('<li class="back-value-data list-group-item" back="'+n.slice(0,n.length-1).join(",")+'" style="cursor:pointer">Back</li>')}catch(t){}$(".value-data").unbind().click(function(){var e=$(this).parent().parent().find(".value-datasource"),a=$(e).val();a+="['"+$(this).attr("value")+"']",$(e).val(a),t($(e).val(),e),$(e).focus()}),$(".back-value-data").unbind().click(function(){for(var e=$(this).attr("back").split(","),a="datasource",i=1;i<e.length;i++)a+="['"+e[i]+"']";$(this).parent().parent().find(".value-datasource").val(a),t(a,$(this).parent().parent().find(".value-datasource"))})};this.setDataAccess=function(t){l=t},this.getDatasourceValue=function(t,a){return"object"==o(a[l[t]])?e.getDatasourceValue(t+1,a[l[t]]):a[l[t]]},this.fatoryGetDatasourceValue=function(t,a){try{return l=t,e.getDatasourceValue(2,i[a])}catch(t){}},this.getDatasources=function(){return i};var g=function(){$("#btn-add-datasource").unbind().click(function(){$("#addDatasource").modal("show")}),$("#btn-add-new-datasource").unbind().click(function(){$.ajax({url:u+"company/static/datasource",method:"POST",data:{static_id:$("#static_id").html(),name:$("#name_datasource").val(),webservice_id:$("#webservice_id").val(),timeInterval:$("#add-data-time-interval").val()},success:function(t){d(),$("#addDatasource").modal("hide")},error:function(t){console.log(t)}})}),$("#Mutiline_value,#Gauges,#TextValue").on("change",".select-datasource",function(){if($(this).parent().next().find(".value-datasource").val(""),$(this).parent().next().find(".data-list").hide(),""!=$(this).val()){var t=v($(this).val());$(this).parent().next().find(".value-datasource").focus(),h(t.name,$(this).parent().next().find(".value-datasource"))}else $(this).parent().next().find(".data-list").empty()}),$("#Mutiline_value,#Gauges,#TextValue").on("focus",".value-datasource",function(){$("#Mutiline_value,#Gauges,#TextValue").find(".data-list.active-data").each(function(){$(this).hide(),$(this).removeClass("active-data")}),$(this).next().addClass("active-data"),$(this).next().show()}),$("#Radar").on("change",".select-datasource",function(){var t=$(this).parent().parent().next().next();if($(t).find(".value-datasource").val(""),$(t).find(".data-list").hide(),$(t).find(".data-list").empty(),""!=$(this).val()){var e=v($(this).val());h(e.name,$(t).find(".value-datasource"))}}),$("#Radar").on("focus",".value-datasource",function(){$(this).parent().parent().find(".data-list.active-data").each(function(){$(this).hide(),$(this).removeClass("active-data")}),$(this).next().addClass("active-data"),$(this).next().show()}),$("#Mutiline_value,#Gauges,#TextValue,#Radar").on("keyup",".value-datasource",function(){m($(this).val(),$(this))})};this.initCreate=function(){g(),$.ajax({url:u+"company/webservices",success:function(t){(a=t.data).map(function(t){$("#webservice_id").append('<option value="'+t.webservice_id+'">'+t.service_name+"</option>")})},error:function(t){console.log(t)}}),d()}},D=function(){function t(){c(this,t);var e={cellHeight:80,verticalMargin:10,float:!1},a=null,i=null,n=null,l=function(){return $("#widget_type").val()},o=function(){return $("#title-name").val()},d=function(){return $("#time-interval").val()},r=function(){return(new Date).toUTCString()},s=function(){if(0==$(".form-radar-value:visible").length){var t=$("#layout-radar-value").html(),e=$("#layout-add-value-radar").html();$("#Radar_value").append(t),$(".radar-labels:visible").each(function(){var t=e.replace("((value-radar))",$(this).val());$(".add-value-radar:visible").append(t)})}else{var a=$("#Radar_value .form-radar-value").html();$("#Radar_value").append('<div class="form-radar-value">'+a+"</div>")}},h=function(){var t,e,a,i,n,s,c,u=l(),p=Math.floor(1e5+9e5*Math.random()),h=null,m=null;console.log(u),u===v.MUTILINE?(m=function(t){var e=$("#Mutiline_value").find(".label-y-chart-line").length,a=[];$("#Mutiline_value").find(".value-datasource:visible").each(function(){a.push($(this).val().match(f))});for(var i=[],n=0;n<e;n++){var s,c=$("#Mutiline_value").find(".label-y-chart-line"),u=$("#Mutiline_value").find(".rgb-chart-line");s={label:$(c[n]).val(),backgroundColor:"rgba(255,255,255,0.0)",borderColor:$(u[n]).val(),borderWidth:2},i.push(s)}return{datasource:a,fullScreenId:"myChartFull_"+t,download:!0,type:l(),title_name:o(),lastUpdate:r(),timeInterval:d(),datasets:[].concat(i)}}(p),(h=new T(Object.assign({},m))).createWidget(),h.createMutiLine()):u===v.TEXTLINE?(m=function(t){var e=$("#text-line").find("#unit").val(),a=$("#value-text-line").find("#rgb").val();return{datasource:[$("#text-line").find(".value-datasource").val().match(f)],fullScreenId:"myChartFull_"+t,download:!0,type:l(),title_name:o(),lastUpdate:r(),timeInterval:d(),rgb:a,unit:e}}(p),(h=new M(m)).createWidget(),h.createTextLine()):u===v.RADAR?(a=[],i=[],n=[],s=[],c=[],$("#Radar").find(".radar-labels:visible").each(function(){i.push($(this).val())}),$("#Radar_value").find(".form-radar-value:visible").each(function(){a.push({}),n.push($(this).find(".label-radar").val()),$(this).find(".value-datasource:visible").each(function(){s.push($(this).val().match(f))}),$(this).find(".radar-color:visible").each(function(){c.push($(this).val())})}),m={datasets:a,labels:i,label:n,color:c,datasource:s,type:l(),title_name:o(),lastUpdate:r(),timeInterval:d()},(h=new k(m)).createWidget(),h.createRadar()):u===v.GAUGES?(m=function(t){var e=$("#Gauges").find("#g_limitMin").val(),a=$("#Gauges").find("#g_limitMax").val(),i=$("#Gauges").find("#unit").val();return{textId:"gauges-text-"+t,datasource:[$("#Gauges").find(".value-datasource").val().match(f)],fullScreenId:"gaugesFull-"+t,download:!0,type:l(),title_name:o(),lastUpdate:r(),timeInterval:d(),limitMax:a,limitMin:e,unit:i,opts:{angle:0,lineWidth:.23,radiusScale:1,pointer:{length:.6,strokeWidth:.035,color:"#000000"},limitMax:!1,limitMin:!1,colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:!0,highDpiSupport:!0,staticLabels:{font:"10px Poppins",labels:[0,Number(a)],color:"#000000",fractionDigits:0}}}}(p),(h=new A(m)).createWidget(),h.createGages()):u===v.MAP?(m=function(t){return{fullScreenId:"mapFull-"+t,download:!1,type:l(),title_name:o(),lastUpdate:r(),timeInterval:d()}}(p),(h=new W(m)).createWidget(),h.createMap()):u===v.TEXTVALUE?(m=function(t){var e=$("#TextValue").find("#unit").val(),a=$("#TextValue").find("#rgb").val();return{datasource:[$("#TextValue").find(".value-datasource").val().match(f)],fullScreenId:"textValueFull-"+t,download:!1,type:l(),title_name:o(),lastUpdate:r(),timeInterval:d(),unit:e,rgb:a}}(p),(h=new U(m)).createWidget(),h.createTextValue()):u===v.TEXTBOX&&(t=$("#text-box").find("#text-custom").val(),e=$("#text-box").find("#font-size").val(),m={type:l(),download:!1,title_name:null,lastUpdate:null,timeInterval:null,textbox:t,fontsize:e},(h=new C(m)).createWidget(),h.createTextBox()),O.push(h)},m=function(){$("#settingW").click(function(){clearInterval(i),$(this).hide(),$(".full-screen").hide(),$(".edit-widget").show(),$("#addW").show(),$("#saveW").show(),$("#cancelW").show(),a.enableMove(!0),a.enableResize(!0)}),$("#widget_type").change(function(){var t;$(".value_widget").hide(),t=l(),$(".value_widget").hide(),$("#default-value").show(),t===v.MUTILINE?$("#MutiLine").show():t===v.TEXTLINE?$("#text-line").show():t===v.RADAR?($("#Radar").show(),(n=new S).createRadarExample(),$("#addWidget").on("change",".radar-labels,.label-radar",function(){n.updateRadarExample()}),$("#btn-add-datasource-radar").unbind().click(function(){$(".remove-radar-labels").prop("disabled",!0),$("#btn-add-label-radar").hide(),$("#btn-edit-label-radar").show(),$(".radar-labels").prop("disabled",!0),s(),n.updateRadarExample(),$(".remove-datasource-radar").unbind().click(function(){$(this).parent().remove(),n.updateRadarExample()})}),$("#btn-edit-label-radar").unbind().click(function(){swal({title:"Are you sure?",text:"When you edit lables datasource will reset",icon:"warning",buttons:!0,dangerMode:!0}).then(function(t){t&&($("#btn-add-label-radar").show(),$("#btn-edit-label-radar").hide(),$("#Radar_value").empty(),$(".radar-labels").prop("disabled",!1),$(".remove-radar-labels").prop("disabled",!1),n.updateRadarExample())})})):t===v.GAUGES?$("#Gauges").show():t===v.TEXTVALUE?$("#TextValue").show():t===v.TEXTBOX?($("#text-box").show(),$("#default-value").hide()):$("#form-input-widget").html("")}),$("#addW").unbind().click(function(){$("#addWidget").modal("show")}),$("#add-new-widget").unbind().click(function(){h()}),$("#saveW").unbind().click(function(){var e;$("#saveW").hide(),$("#addW").hide(),$("#cancelW").hide(),$("#settingW").show(),$(".full-screen").show(),$(".edit-widget").hide(),g(),e=_.map($(".grid-stack > .grid-stack-item:visible"),function(e){var a=(e=$(e)).data("_gridstack_node"),i=t.getWidgetById(a.id);return{x:a.x,y:a.y,width:a.width,height:a.height,widget:E.formateDataSave(i)}}),$.ajax({url:u+"company/static/dashboard",method:"PUT",data:{static_id:$("#static_id").html(),dashboard:JSON.stringify(e,null,"")},success:function(t){console.log(t)},error:function(t){console.log(t)}}),a.enableMove(!1),a.enableResize(!1)}),$("#cancelW").unbind().click(function(){$("#saveW").hide(),$("#addW").hide(),$(".edit-widget").hide(),$(".full-screen").show(),$("#cancelW").hide(),$("#settingW").show(),g(),a.enableMove(!1),a.enableResize(!1)}),$("#btn-add-value-Mutiline").unbind().click(function(){var t;t=$("#line_value_layout").first().html(),$("#Mutiline_value").append(t)}),$("#btn-detail-toggle ").unbind().click(function(){$("#top-header").slideToggle("fast"),$(this).toggleClass("flip")}),$("#Mutiline_value").on("click",".remove-value",function(){$(this).parent().parent().remove()}),$("#addWidget").unbind().on("click","#btn-add-label-radar",function(){$("#Radar_label").append('  <div class="input-group">\n                                                <input type="text" class="form-control radar-labels mt-2" value="">\n                                                <div class="input-group-append">\n                                                    <button class="btn btn-danger mt-2  remove-radar-labels" type="button"><i class="fas fa-times"></i></button>\n                                                </div>\n                                            </div>'),n.updateRadarExample()}),$("#Radar_value").on("change",".radar-color",function(){n.updateRadarExample()}),$("#Radar_label").unbind().on("click",".remove-radar-labels",function(){$(this).parent().parent().remove(),n.updateRadarExample()})},g=function(){i=setInterval(function(){O.length>0&&b([].concat(O))},1e3)},b=function(e){for(var a=0;a<e.length;a++){var i=e[a];i.updateData&&(t.diffTime(i.lastUpdate,i.timeInterval)>=i.timeInterval?i.updateData():i.liveData&&i.liveData())}};this.initDashboard=function(){p=new R,m();$.ajax({url:u+"company/static/"+$("#static_id").html(),method:"GET",success:function(t){t.data&&(function(t){var e=null,a=null,i=null,n="";for(var l in t)e=null,a=t[l].widget,i=t[l],n=a.type,a.lastUpdate=r(),n===v.MUTILINE?((e=new T(a)).createWidget(i),e.createMutiLine()):n===v.GAUGES?((e=new A(a)).createWidget(i),e.createGages()):n===v.RADAR?((e=new k(a)).createWidget(i),e.createRadar()):n===v.TEXTLINE?((e=new M(a)).createWidget(i),e.createTextLine()):n===v.MAP?((e=new W(a)).createWidget(i),e.createMap()):n===v.TEXTVALUE?((e=new U(a)).createWidget(i),e.createTextValue()):n===v.TEXTBOX&&((e=new C(a)).createWidget(i),e.createTextBox()),O.push(e);$(".edit-widget").hide()}(GridStackUI.Utils.sort(JSON.parse(t.data[0].dashboard))),$("#loading").remove(),g(),$(".grid-stack").gridstack(e),(a=$(".grid-stack").data("gridstack")).enableMove(!1),a.enableResize(!1),p.initCreate())},error:function(t){console.log(t)}})}}return d(t,null,[{key:"diffTime",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=new Date,a=new Date(t),i=(e.getTime()-a.getTime())/1e3;return Math.abs(Math.round(i))}},{key:"updateGridData",value:function(t){}},{key:"getWidgetById",value:function(t){return O.find(function(e){return e.itemId==t})}}]),t}();$(document).ready(function(){$("#sidebarCollapse").click(),(new D).initDashboard(),$(".grid-stack").on("gsresizestop",function(t,e){var a=$(e),i=JSON.parse(a.data("_gridstack_data")),n=a.data("_gridstack_node"),l=i.type;if("Gauges"===l);else if("MutiLine"===l){t.target,a.find(".card-body").width(),a.find(".card-body").height();var o=a.find(".card-body");$(o).find("canvas")}else if("Map"===l){D.getWidgetById(n.id).myMap.invalidateSize()}})})},DuR2:function(t,e){var a;a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(a=window)}t.exports=a},t4zo:function(t,e,a){(function(a){var i,n,l;n=[],void 0===(l="function"==typeof(i=function(){"use strict";function e(t,e,a){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){o(i.response,e,a)},i.onerror=function(){console.error("could not download file")},i.send()}function i(t){var e=new XMLHttpRequest;return e.open("HEAD",t,!1),e.send(),200<=e.status&&299>=e.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(a){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,o=l.saveAs||"object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype?function(t,a,o){var d=l.URL||l.webkitURL,r=document.createElement("a");a=a||t.name||"download",r.download=a,r.rel="noopener","string"==typeof t?(r.href=t,r.origin===location.origin?n(r):i(r.href)?e(t,a,o):n(r,r.target="_blank")):(r.href=d.createObjectURL(t),setTimeout(function(){d.revokeObjectURL(r.href)},4e4),setTimeout(function(){n(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,a,l){if(a=a||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Depricated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,l),a);else if(i(t))e(t,a,l);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){n(o)})}}:function(t,a,i,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return e(t,a,i);var o="application/octet-stream"===t.type,d=/constructor/i.test(l.HTMLElement)||l.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||o&&d)&&"object"==typeof FileReader){var s=new FileReader;s.onloadend=function(){var t=s.result;t=r?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},s.readAsDataURL(t)}else{var c=l.URL||l.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}};l.saveAs=o.saveAs=o,void 0!==t&&(t.exports=o)})?i.apply(e,n):i)||(t.exports=l)}).call(e,a("DuR2"))}});